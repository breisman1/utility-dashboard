<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Utility Subsidy Operations Dashboard</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    #root {
      width: 100%;
      height: 100vh;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useMemo } = React;

    // Lucide icons as simple SVG components
    const Search = ({ size = 24, ...props }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
        <circle cx="11" cy="11" r="8"></circle>
        <path d="m21 21-4.35-4.35"></path>
      </svg>
    );

    const Filter = ({ size = 24, ...props }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
        <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
      </svg>
    );

    const Send = ({ size = 24, ...props }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
        <line x1="22" y1="2" x2="11" y2="13"></line>
        <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
      </svg>
    );

    const Clock = ({ size = 24, ...props }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
        <circle cx="12" cy="12" r="10"></circle>
        <polyline points="12 6 12 12 16 14"></polyline>
      </svg>
    );

    const AlertTriangle = ({ size = 24, ...props }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
        <path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"></path>
        <line x1="12" y1="9" x2="12" y2="13"></line>
        <line x1="12" y1="17" x2="12.01" y2="17"></line>
      </svg>
    );

    const CheckCircle = ({ size = 24, ...props }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
        <polyline points="22 4 12 14.01 9 11.01"></polyline>
      </svg>
    );

    const ChevronRight = ({ size = 24, ...props }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
        <polyline points="9 18 15 12 9 6"></polyline>
      </svg>
    );

    const Mail = ({ size = 24, ...props }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
        <rect x="2" y="4" width="20" height="16" rx="2"></rect>
        <path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"></path>
      </svg>
    );

    const Phone = ({ size = 24, ...props }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
        <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
      </svg>
    );

    const ArrowUpDown = ({ size = 24, ...props }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
        <path d="m21 16-4 4-4-4"></path>
        <path d="M17 20V4"></path>
        <path d="m3 8 4-4 4 4"></path>
        <path d="M7 4v16"></path>
      </svg>
    );

    // Mock data generator (same as before)
    const generateMockData = () => {
      const californiaUtilities = [
        'Pacific Gas & Electric', 'Southern California Edison', 'San Diego Gas & Electric',
        'Sacramento Municipal Utility District', 'Los Angeles Department of Water & Power',
        'Imperial Irrigation District', 'Modesto Irrigation District', 'Turlock Irrigation District',
        'Roseville Electric', 'Silicon Valley Power', 'Anaheim Public Utilities',
        'Riverside Public Utilities', 'Glendale Water & Power', 'Pasadena Water & Power',
        'Burbank Water & Power', 'Lodi Electric Utility', 'Azusa Light & Water',
        'Alameda Municipal Power', 'Healdsburg Electric', 'Lompoc Electric',
        'Palo Alto Utilities', 'Redding Electric Utility', 'Shasta Dam Area Public Utility',
        'Trinity Public Utilities District', 'Plumas-Sierra Rural Electric Cooperative',
        'Anza Electric Cooperative', 'Valley Electric Association', 'Surprise Valley Electrification',
        'Kirkwood Meadows Public Utility District', 'Bear Valley Electric Service',
        'Liberty Utilities', 'PacifiCorp', 'Truckee Donner Public Utility District',
        'Rancho Cucamonga Municipal Utility', 'Moreno Valley Utility Authority',
        'Corona Department of Water & Power', 'Colton Electric Utility',
        'Banning Electric Department', 'Vernon Light & Power', 'Biggs Municipal Utilities',
        'Gridley Municipal Utilities', 'Ukiah Valley Electric', 'Willits Electric',
        'Fort Bragg Electric', 'Pittsburg Power Company', 'Port of Oakland',
        'Port of Long Beach Harbor Department', 'Mammoth Community Water District',
        'June Lake Public Utility District', 'Northstar Community Services District',
        'Alpine County Water District', 'Calaveras County Water District',
        'El Dorado Irrigation District', 'Nevada Irrigation District', 
        'Placer County Water Agency', 'Georgetown Divide Public Utility District',
        'Tuolumne Utilities District', 'Mariposa Public Utility District',
        'Merced Irrigation District', 'Madera Irrigation District'
      ];

      const cities = [
        'San Francisco', 'Los Angeles', 'San Diego', 'Sacramento', 'Fresno',
        'Oakland', 'San Jose', 'Long Beach', 'Bakersfield', 'Anaheim',
        'Riverside', 'Stockton', 'Modesto', 'Santa Rosa', 'Eureka',
        'Redding', 'Chico', 'Visalia', 'Santa Barbara', 'San Luis Obispo'
      ];

      const taskTypes = [
        { name: 'Sign Bank Transfer Agreement', category: 'blocker', weight: 10 },
        { name: 'Grant API Access', category: 'blocker', weight: 10 },
        { name: 'Validate Disbursement Amounts', category: 'disbursement-dependent', weight: 7 },
        { name: 'Remove Flagged Customer', category: 'disbursement-dependent', weight: 7 },
        { name: 'Reconcile Duplicate Records', category: 'disbursement-dependent', weight: 6 },
        { name: 'Submit Monthly Report', category: 'compliance', weight: 8 },
        { name: 'Confirm Credits Applied', category: 'compliance', weight: 8 },
        { name: 'Update Documentation', category: 'compliance', weight: 5 },
        { name: 'Provide Customer Data Export', category: 'operational', weight: 3 },
        { name: 'Update Contact Information', category: 'operational', weight: 2 },
        { name: 'Review System Integration', category: 'operational', weight: 4 },
        { name: 'Upload Supporting Documents', category: 'operational', weight: 3 }
      ];

      const roles = ['Finance Director', 'Operations Manager', 'Compliance Officer', 'IT Director', 'Customer Service Manager'];
      
      const firstNames = ['John', 'Sarah', 'Michael', 'Jennifer', 'David', 'Lisa', 'Robert', 'Maria', 'James', 'Patricia',
                           'William', 'Linda', 'Richard', 'Elizabeth', 'Thomas', 'Margaret', 'Daniel', 'Susan', 'Carlos', 'Jessica'];
      const lastNames = ['Smith', 'Johnson', 'Williams', 'Brown', 'Jones', 'Garcia', 'Miller', 'Davis', 'Rodriguez', 'Martinez',
                         'Hernandez', 'Lopez', 'Wilson', 'Anderson', 'Thomas', 'Taylor', 'Moore', 'Jackson', 'Lee', 'White'];

      return californiaUtilities.slice(0, 60).map((name, idx) => {
        const numTasks = Math.floor(Math.random() * 7) + 2;
        const numContacts = Math.floor(Math.random() * 3) + 3;
        const isHighTouch = Math.random() > 0.75;
        const customerCount = Math.floor(Math.random() * 500000) + 2000;
        
        const contacts = Array.from({ length: numContacts }, (_, i) => ({
          id: `${idx}-${i}`,
          name: `${firstNames[Math.floor(Math.random() * firstNames.length)]} ${lastNames[Math.floor(Math.random() * lastNames.length)]}`,
          role: roles[i % roles.length],
          email: `contact${i}@${name.toLowerCase().replace(/[^a-z]/g, '')}.com`,
          phone: `(${Math.floor(Math.random() * 900) + 100}) ${Math.floor(Math.random() * 900) + 100}-${Math.floor(Math.random() * 9000) + 1000}`,
          responseTime: Math.floor(Math.random() * 8) + 1
        }));

        const tasks = Array.from({ length: numTasks }, (_, i) => {
          const task = taskTypes[Math.floor(Math.random() * taskTypes.length)];
          const daysUntilDue = Math.floor(Math.random() * 30) - 10;
          const daysSinceAssigned = Math.floor(Math.random() * 45) + 1;
          const lastContactDays = Math.floor(Math.random() * 20) + 1;
          const remindersSent = Math.floor(Math.random() * 4);
          
          return {
            id: `${idx}-task-${i}`,
            ...task,
            daysUntilDue,
            daysSinceAssigned,
            lastContactDays,
            remindersSent,
            assignedTo: contacts[Math.floor(Math.random() * contacts.length)],
            status: daysUntilDue < -5 ? 'overdue' : daysUntilDue < 0 ? 'overdue' : daysUntilDue < 3 ? 'urgent' : 'pending'
          };
        });

        const blockerOverdue = tasks.some(t => t.category === 'blocker' && t.daysUntilDue < -3);
        const criticalOverdue = tasks.filter(t => t.status === 'overdue' && t.category === 'blocker').length;
        const complianceOverdue = tasks.filter(t => t.status === 'overdue' && t.category === 'compliance').length;
        const totalOverdue = tasks.filter(t => t.status === 'overdue').length;
        const hasUrgent = tasks.filter(t => t.status === 'urgent').length;
        const noActivityRecent = Math.min(...tasks.map(t => t.lastContactDays)) > 30;
        
        let healthStatus = 'healthy';
        // Only critical if severely blocked
        if (blockerOverdue || criticalOverdue >= 1 || complianceOverdue >= 2) {
          healthStatus = 'critical';
        } 
        // Warning if multiple issues piling up
        else if (totalOverdue >= 3 || hasUrgent >= 4 || noActivityRecent) {
          healthStatus = 'warning';
        }
        // Otherwise healthy - a few overdue/urgent tasks is normal

        const riskScore = tasks.reduce((score, task) => {
          let taskScore = 0;
          if (task.status === 'overdue') taskScore += task.weight * 2;
          if (task.status === 'urgent') taskScore += task.weight;
          if (task.category === 'blocker') taskScore *= 1.5;
          return score + taskScore;
        }, 0);

        return {
          id: `util-${idx}`,
          name,
          city: cities[Math.floor(Math.random() * cities.length)],
          customerCount,
          contacts,
          tasks,
          healthStatus,
          riskScore: Math.round(riskScore),
          isHighTouch,
          lastActivity: Math.min(...tasks.map(t => t.lastContactDays)),
          nextDeadline: Math.min(...tasks.map(t => t.daysUntilDue))
        };
      }).sort((a, b) => b.riskScore - a.riskScore);
    };

    const UtilityDashboard = () => {
      const [utilities, setUtilities] = useState(generateMockData());
      const [selectedUtility, setSelectedUtility] = useState(null);
      const [searchTerm, setSearchTerm] = useState('');
      const [filterStatus, setFilterStatus] = useState('all');
      const [filterCategory, setFilterCategory] = useState('all');
      const [sortBy, setSortBy] = useState('risk');
      const [view, setView] = useState('thisweek');
      const [emailDraft, setEmailDraft] = useState(null);
      const [selectedUtilities, setSelectedUtilities] = useState(new Set());
      const [showBulkActions, setShowBulkActions] = useState(false);
      const [reassignModal, setReassignModal] = useState(null); // { utility, task }
      const [filterAssignee, setFilterAssignee] = useState('all'); // New filter for assignee
      const [analyticsView, setAnalyticsView] = useState('executive'); // Sub-view within analytics
      
      // Team members who can be assigned tasks
      const teamMembers = [
        { id: 1, name: 'Sarah Chen', role: 'Program Manager', avatar: 'ðŸ‘©', color: 'rgb(59, 130, 246)' },
        { id: 2, name: 'Marcus Johnson', role: 'Compliance Specialist', avatar: 'ðŸ‘¨', color: 'rgb(147, 51, 234)' },
        { id: 3, name: 'Elena Rodriguez', role: 'Operations Lead', avatar: 'ðŸ‘©', color: 'rgb(236, 72, 153)' },
        { id: 4, name: 'David Kim', role: 'Technical Coordinator', avatar: 'ðŸ‘¨', color: 'rgb(34, 197, 94)' },
        { id: 5, name: 'You', role: 'Senior PM', avatar: 'â­', color: 'rgb(251, 146, 60)' }
      ];

      const filteredUtilities = useMemo(() => {
        let filtered = utilities.filter(() => true); // Create new array

        if (searchTerm) {
          filtered = filtered.filter(u => 
            u.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
            u.city.toLowerCase().includes(searchTerm.toLowerCase())
          );
        }

        if (filterStatus !== 'all') {
          filtered = filtered.filter(u => u.healthStatus === filterStatus);
        }

        if (filterCategory !== 'all') {
          filtered = filtered.filter(u => 
            u.tasks.some(t => t.category === filterCategory && t.status !== 'completed')
          );
        }

        if (filterAssignee !== 'all') {
          filtered = filtered.filter(u => {
            const utilityHash = u.id.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);
            const shouldHaveAssignee = utilityHash % 4 !== 0;
            if (filterAssignee === 'unassigned') {
              return !shouldHaveAssignee;
            } else {
              const assignedMemberId = parseInt(filterAssignee);
              return shouldHaveAssignee && (utilityHash % teamMembers.length) === (assignedMemberId - 1);
            }
          });
        }

        switch(sortBy) {
          case 'risk':
            filtered.sort((a, b) => b.riskScore - a.riskScore);
            break;
          case 'deadline':
            filtered.sort((a, b) => a.nextDeadline - b.nextDeadline);
            break;
          case 'activity':
            filtered.sort((a, b) => b.lastActivity - a.lastActivity);
            break;
          case 'name':
            filtered.sort((a, b) => a.name.localeCompare(b.name));
            break;
          default:
            break;
        }

        return filtered;
      }, [utilities, searchTerm, filterStatus, filterCategory, sortBy, filterAssignee]);

      const thisWeekUtilities = useMemo(() => {
        return utilities
          .filter(u => u.tasks.some(t => t.daysUntilDue <= 7 && t.daysUntilDue >= -2))
          .sort((a, b) => a.nextDeadline - b.nextDeadline);
      }, [utilities]);

      const generateEmailDraft = (utility, task) => {
        const contact = task.assignedTo;
        const daysText = task.daysUntilDue < 0 
          ? `${Math.abs(task.daysUntilDue)} days overdue`
          : task.daysUntilDue === 0
          ? 'due today'
          : `due in ${task.daysUntilDue} days`;
        
        let greeting = `Hi ${contact.name.split(' ')[0]},`;
        let body = '';
        let subject = '';

        if (task.category === 'blocker') {
          subject = `[ACTION REQUIRED] ${task.name} - ${utility.name}`;
          body = `I hope this message finds you well.\n\nI'm reaching out regarding a critical action item for ${utility.name}'s participation in the government subsidy program.\n\n**Task:** ${task.name}\n**Status:** This task is ${daysText} and is currently blocking all disbursement processing for your utility.\n**Impact:** Until this is completed, we cannot process any subsidy payments to ${utility.name}.\n\n`;
          
          if (task.remindersSent > 0) {
            body += `This is our ${task.remindersSent === 1 ? '2nd' : task.remindersSent === 2 ? '3rd' : `${task.remindersSent + 1}th`} attempt to reach you about this matter. `;
          }
          
          body += `Could you please prioritize completing this task? If you're experiencing any difficulties or have questions, I'm here to help.\n\n`;
        } else if (task.category === 'disbursement-dependent') {
          subject = `Reminder: ${task.name} - ${utility.name}`;
          body = `I hope you're doing well.\n\nI wanted to follow up on an outstanding task for ${utility.name}'s subsidy program participation.\n\n**Task:** ${task.name}\n**Status:** ${daysText.charAt(0).toUpperCase() + daysText.slice(1)}\n**Impact:** This task must be completed before we can process your next disbursement batch.\n\n`;
          
          if (task.daysUntilDue < 0) {
            body += `This task is now overdue. To avoid delays in your next payment cycle, please complete this as soon as possible.\n\n`;
          }
        } else if (task.category === 'compliance') {
          subject = `[Compliance] ${task.name} - ${utility.name}`;
          body = `Hi ${contact.name.split(' ')[0]},\n\nThis is a reminder about a compliance requirement for ${utility.name}'s participation in the subsidy program.\n\n**Task:** ${task.name}\n**Status:** ${daysText.charAt(0).toUpperCase() + daysText.slice(1)}\n**Requirement:** This is needed to maintain compliance with program reporting requirements.\n\n`;
        } else {
          subject = `Follow-up: ${task.name} - ${utility.name}`;
          body = `Hi ${contact.name.split(' ')[0]},\n\nI wanted to check in about an outstanding task for ${utility.name}.\n\n**Task:** ${task.name}\n**Status:** ${daysText.charAt(0).toUpperCase() + daysText.slice(1)}\n\n`;
        }

        body += `**What's needed:** Please let me know if you need any assistance or clarification on how to complete this task. I'm happy to schedule a quick call if that would be helpful.\n\n`;
        
        if (task.daysUntilDue <= 2 && task.daysUntilDue >= 0) {
          body += `**Time-sensitive:** With the deadline approaching quickly, please prioritize this task.\n\n`;
        }

        body += `Thank you for your attention to this matter.\n\nBest regards,\n[Your Name]\nSubsidy Program Coordinator\n[Your Contact Information]`;

        return {
          to: contact.email,
          subject,
          body,
          contact,
          utility,
          task
        };
      };

      // Toggle utility selection for bulk actions
      const toggleUtilitySelection = (utilityId) => {
        const newSelected = new Set(selectedUtilities);
        if (newSelected.has(utilityId)) {
          newSelected.delete(utilityId);
        } else {
          newSelected.add(utilityId);
        }
        setSelectedUtilities(newSelected);
        setShowBulkActions(newSelected.size > 0);
      };

      // Select all filtered utilities
      const selectAllFiltered = () => {
        const newSelected = new Set(filteredUtilities.map(u => u.id));
        setSelectedUtilities(newSelected);
        setShowBulkActions(true);
      };

      // Clear all selections
      const clearSelections = () => {
        setSelectedUtilities(new Set());
        setShowBulkActions(false);
      };

      // Send bulk reminders
      const sendBulkReminders = () => {
        const count = selectedUtilities.size;
        alert(`Sending reminders to ${count} utilities...\n\nIn production, this would:\nâ€¢ Generate ${count} customized emails\nâ€¢ Queue them for delivery\nâ€¢ Log the activity\nâ€¢ Update reminder counts`);
        clearSelections();
      };

      // Mark task as complete
      const completeTask = (utilityId, taskId) => {
        setUtilities(prevUtilities => 
          prevUtilities.map(u => {
            if (u.id === utilityId) {
              return {
                ...u,
                tasks: u.tasks.map(t => 
                  t.id === taskId ? { ...t, status: 'completed', completedDate: new Date().toISOString() } : t
                )
              };
            }
            return u;
          })
        );
        alert('Task marked as complete! âœ…');
      };

      // Reassign task to team member
      const reassignTask = (utilityId, taskId, teamMember) => {
        setUtilities(prevUtilities => 
          prevUtilities.map(u => {
            if (u.id === utilityId) {
              return {
                ...u,
                tasks: u.tasks.map(t => 
                  t.id === taskId ? { ...t, internalAssignee: teamMember } : t
                )
              };
            }
            return u;
          })
        );
        setReassignModal(null);
        alert(`Task reassigned to ${teamMember.name}! ðŸ‘`);
      };

      // Export to CSV
      const exportToCSV = () => {
        const headers = ['Utility Name', 'City', 'Health Status', 'Risk Score', 'Tasks', 'Overdue Tasks', 'Next Deadline'];
        const rows = utilities.map(u => [
          u.name,
          u.city,
          u.healthStatus,
          u.riskScore,
          u.tasks.length,
          u.tasks.filter(t => t.status === 'overdue').length,
          u.nextDeadline < 0 ? `${Math.abs(u.nextDeadline)}d overdue` : `${u.nextDeadline}d`
        ]);
        
        const csvContent = [
          headers.join(','),
          ...rows.map(row => row.join(','))
        ].join('\n');
        
        const blob = new Blob([csvContent], { type: 'text/csv' });
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `utility-dashboard-${new Date().toISOString().split('T')[0]}.csv`;
        a.click();
        window.URL.revokeObjectURL(url);
      };

      // Export to PDF (simplified - in production would use jsPDF)
      const exportToPDF = () => {
        alert('PDF Export\n\nIn production, this would generate a comprehensive PDF report including:\n\nâ€¢ Executive summary\nâ€¢ Health status breakdown\nâ€¢ Critical utilities list\nâ€¢ Task completion statistics\nâ€¢ Team workload distribution\nâ€¢ Trend charts\n\nFor this demo, use the CSV export or print this page (Ctrl/Cmd + P)');
      };

      const stats = useMemo(() => {
        const complianceIssues = utilities.filter(u => 
          u.tasks.some(t => t.category === 'compliance' && (t.status === 'overdue' || t.daysUntilDue <= 3))
        ).length;
        
        const criticalBlockers = utilities.filter(u => 
          u.tasks.some(t => t.category === 'blocker' && (t.status === 'overdue' || t.daysUntilDue <= 0))
        ).length;
        
        const dueThisWeek = utilities.filter(u => 
          u.tasks.some(t => t.daysUntilDue >= 0 && t.daysUntilDue <= 7)
        ).length;
        
        const noResponse = utilities.filter(u => 
          u.lastActivity >= 7
        ).length;
        
        // Simulate completed this week (in production would track actual completions)
        const completedThisWeek = Math.floor(utilities.length * 0.15); // ~15% completion rate
        
        return { complianceIssues, criticalBlockers, dueThisWeek, noResponse, completedThisWeek };
      }, [utilities]);

      // Click handlers for action stats
      const handleComplianceClick = () => {
        setView('queue');
        setFilterCategory('compliance');
        setFilterStatus('all');
        setSortBy('deadline');
      };

      const handleBlockersClick = () => {
        setView('queue');
        setFilterCategory('blocker');
        setFilterStatus('critical');
        setSortBy('risk');
      };

      const handleDueThisWeekClick = () => {
        setView('thisweek');
      };

      const handleNoResponseClick = () => {
        setView('queue');
        setFilterCategory('all');
        setFilterStatus('all');
        setSortBy('activity');
      };

      const handleCompletedClick = () => {
        alert('Completed This Week âœ…\n\nIn production, this would show:\nâ€¢ List of completed tasks\nâ€¢ Who completed them\nâ€¢ Timeline of completions\nâ€¢ Celebration messages ðŸŽ‰\n\nGreat job team!');
      };

      const getStatusColor = (status) => {
        switch(status) {
          case 'critical': return 'rgb(239, 68, 68)';
          case 'warning': return 'rgb(251, 146, 60)';
          case 'healthy': return 'rgb(34, 197, 94)';
          default: return 'rgb(156, 163, 175)';
        }
      };

      const getCategoryColor = (category) => {
        switch(category) {
          case 'blocker': return 'rgb(239, 68, 68)';
          case 'disbursement-dependent': return 'rgb(251, 146, 60)';
          case 'compliance': return 'rgb(59, 130, 246)';
          case 'operational': return 'rgb(156, 163, 175)';
          default: return 'rgb(156, 163, 175)';
        }
      };

      return React.createElement('div', { 
        style: {
          minHeight: '100vh',
          background: 'linear-gradient(to bottom right, rgb(15, 23, 42), rgb(30, 41, 59))',
          color: 'rgb(248, 250, 252)',
          fontFamily: "'Inter', -apple-system, sans-serif",
          padding: '0'
        }
      },
        // Header
        React.createElement('div', {
          style: {
            background: 'rgba(15, 23, 42, 0.95)',
            backdropFilter: 'blur(12px)',
            borderBottom: '1px solid rgba(148, 163, 184, 0.1)',
            padding: '1.5rem 2rem',
            position: 'sticky',
            top: 0,
            zIndex: 50
          }
        },
          React.createElement('div', { style: { display: 'flex', justifyContent: 'space-between', alignItems: 'center' } },
            React.createElement('div', null,
              React.createElement('h1', {
                style: {
                  margin: 0,
                  fontSize: '1.875rem',
                  fontWeight: '700',
                  letterSpacing: '-0.025em',
                  background: 'linear-gradient(to right, rgb(255, 255, 255), rgb(203, 213, 225))',
                  WebkitBackgroundClip: 'text',
                  WebkitTextFillColor: 'transparent'
                }
              }, 'Utility Subsidy Operations'),
              React.createElement('p', {
                style: { margin: '0.25rem 0 0 0', fontSize: '0.875rem', color: 'rgb(148, 163, 184)' }
              }, 'California State Program â€¢ 60 Active Utilities')
            ),
            React.createElement('div', { style: { display: 'flex', gap: '1rem', alignItems: 'center' } },
              React.createElement('button', {
                onClick: exportToCSV,
                style: {
                  padding: '0.5rem 1rem',
                  background: 'rgba(34, 197, 94, 0.1)',
                  border: '1px solid rgba(34, 197, 94, 0.3)',
                  borderRadius: '0.5rem',
                  color: 'rgb(134, 239, 172)',
                  cursor: 'pointer',
                  fontSize: '0.875rem',
                  fontWeight: '500',
                  transition: 'all 0.2s'
                }
              }, 'ðŸ“Š Export CSV'),
              React.createElement('button', {
                onClick: exportToPDF,
                style: {
                  padding: '0.5rem 1rem',
                  background: 'rgba(239, 68, 68, 0.1)',
                  border: '1px solid rgba(239, 68, 68, 0.3)',
                  borderRadius: '0.5rem',
                  color: 'rgb(252, 165, 165)',
                  cursor: 'pointer',
                  fontSize: '0.875rem',
                  fontWeight: '500',
                  transition: 'all 0.2s'
                }
              }, 'ðŸ“„ Export PDF'),
              React.createElement('button', {
                onClick: () => setView('team'),
                style: {
                  padding: '0.5rem 1rem',
                  background: view === 'team' ? 'rgba(147, 51, 234, 0.2)' : 'transparent',
                  border: view === 'team' ? '1px solid rgb(147, 51, 234)' : '1px solid rgba(148, 163, 184, 0.2)',
                  borderRadius: '0.5rem',
                  color: view === 'team' ? 'rgb(192, 132, 252)' : 'rgb(203, 213, 225)',
                  cursor: 'pointer',
                  fontSize: '0.875rem',
                  fontWeight: '500',
                  transition: 'all 0.2s'
                }
              }, 'ðŸ‘¥ Team'),
              React.createElement('button', {
                onClick: () => setView('thisweek'),
                style: {
                  padding: '0.5rem 1rem',
                  background: view === 'thisweek' ? 'rgba(34, 197, 94, 0.2)' : 'transparent',
                  border: view === 'thisweek' ? '1px solid rgb(34, 197, 94)' : '1px solid rgba(148, 163, 184, 0.2)',
                  borderRadius: '0.5rem',
                  color: view === 'thisweek' ? 'rgb(134, 239, 172)' : 'rgb(203, 213, 225)',
                  cursor: 'pointer',
                  fontSize: '0.875rem',
                  fontWeight: '500',
                  transition: 'all 0.2s',
                  display: 'flex',
                  alignItems: 'center',
                  gap: '0.5rem'
                }
              },
                React.createElement(Clock, { size: 16 }),
                'This Week'
              ),
              React.createElement('button', {
                onClick: () => setView('queue'),
                style: {
                  padding: '0.5rem 1rem',
                  background: view === 'queue' ? 'rgba(59, 130, 246, 0.2)' : 'transparent',
                  border: view === 'queue' ? '1px solid rgb(59, 130, 246)' : '1px solid rgba(148, 163, 184, 0.2)',
                  borderRadius: '0.5rem',
                  color: view === 'queue' ? 'rgb(147, 197, 253)' : 'rgb(203, 213, 225)',
                  cursor: 'pointer',
                  fontSize: '0.875rem',
                  fontWeight: '500',
                  transition: 'all 0.2s'
                }
              }, 'Action Queue'),
              React.createElement('button', {
                onClick: () => setView('analytics'),
                style: {
                  padding: '0.5rem 1rem',
                  background: view === 'analytics' ? 'rgba(59, 130, 246, 0.2)' : 'transparent',
                  border: view === 'analytics' ? '1px solid rgb(59, 130, 246)' : '1px solid rgba(148, 163, 184, 0.2)',
                  borderRadius: '0.5rem',
                  color: view === 'analytics' ? 'rgb(147, 197, 253)' : 'rgb(203, 213, 225)',
                  cursor: 'pointer',
                  fontSize: '0.875rem',
                  fontWeight: '500',
                  transition: 'all 0.2s'
                }
              }, 'Analytics')
            )
          )
        ),

        // Action Center Stats Bar
        React.createElement('div', {
          style: {
            padding: '2rem',
            display: 'grid',
            gridTemplateColumns: 'repeat(5, 1fr)',
            gap: '1.5rem'
          }
        },
          React.createElement(ActionStatCard, { 
            label: 'Compliance Issues', 
            value: stats.complianceIssues, 
            color: 'rgb(239, 68, 68)', 
            icon: 'ðŸš¨',
            onClick: handleComplianceClick,
            description: 'Regulatory risk'
          }),
          React.createElement(ActionStatCard, { 
            label: 'Critical Blockers', 
            value: stats.criticalBlockers, 
            color: 'rgb(251, 146, 60)', 
            icon: 'âš¡',
            onClick: handleBlockersClick,
            description: 'Payments frozen'
          }),
          React.createElement(ActionStatCard, { 
            label: 'Due This Week', 
            value: stats.dueThisWeek, 
            color: 'rgb(234, 179, 8)', 
            icon: 'ðŸ“…',
            onClick: handleDueThisWeekClick,
            description: 'Proactive window'
          }),
          React.createElement(ActionStatCard, { 
            label: 'No Response (7+ days)', 
            value: stats.noResponse, 
            color: 'rgb(147, 51, 234)', 
            icon: 'ðŸ”•',
            onClick: handleNoResponseClick,
            description: 'Needs escalation'
          }),
          React.createElement(ActionStatCard, { 
            label: 'Completed This Week', 
            value: stats.completedThisWeek, 
            color: 'rgb(34, 197, 94)', 
            icon: 'âœ…',
            onClick: handleCompletedClick,
            description: 'Team progress'
          })
        ),

        // Money at Risk Summary Banner
        React.createElement('div', {
          style: {
            margin: '0 2rem 2rem 2rem',
            padding: '1rem 1.5rem',
            background: 'linear-gradient(135deg, rgba(251, 146, 60, 0.1) 0%, rgba(239, 68, 68, 0.1) 100%)',
            border: '1px solid rgba(251, 146, 60, 0.3)',
            borderRadius: '0.5rem',
            display: 'flex',
            justifyContent: 'space-between',
            alignItems: 'center'
          }
        },
          React.createElement('div', { style: { display: 'flex', alignItems: 'center', gap: '1rem' } },
            React.createElement('div', {
              style: { fontSize: '2rem' }
            }, 'ðŸ’°'),
            React.createElement('div', null,
              React.createElement('div', {
                style: { fontSize: '0.75rem', color: 'rgb(148, 163, 184)', textTransform: 'uppercase', letterSpacing: '0.05em', fontWeight: '600' }
              }, 'Money at Risk'),
              React.createElement('div', {
                style: { fontSize: '1.25rem', fontWeight: '700', color: 'rgb(251, 146, 60)', marginTop: '0.25rem' }
              }, `$${(utilities.filter(u => u.tasks.some(t => t.category === 'blocker')).length * 125000).toLocaleString()}`)
            )
          ),
          React.createElement('div', {
            style: { fontSize: '0.875rem', color: 'rgb(203, 213, 225)', textAlign: 'right' }
          },
            React.createElement('div', null, 
              `${utilities.filter(u => u.tasks.some(t => t.category === 'blocker')).length} utilities with blocked disbursements`
            ),
            React.createElement('div', {
              style: { fontSize: '0.75rem', color: 'rgb(148, 163, 184)', marginTop: '0.25rem' }
            }, `~${(utilities.filter(u => u.tasks.some(t => t.category === 'blocker')).reduce((sum, u) => sum + u.customerCount, 0)).toLocaleString()} customers waiting`)
          )
        ),

        // Bulk Actions Toolbar
        showBulkActions && React.createElement('div', {
          style: {
            margin: '0 2rem',
            padding: '1rem 1.5rem',
            background: 'rgba(59, 130, 246, 0.1)',
            border: '1px solid rgba(59, 130, 246, 0.3)',
            borderRadius: '0.75rem',
            display: 'flex',
            justifyContent: 'space-between',
            alignItems: 'center'
          }
        },
          React.createElement('div', { style: { display: 'flex', alignItems: 'center', gap: '1rem' } },
            React.createElement('div', {
              style: { fontSize: '0.875rem', fontWeight: '600', color: 'rgb(147, 197, 253)' }
            }, `${selectedUtilities.size} selected`),
            React.createElement('button', {
              onClick: clearSelections,
              style: {
                padding: '0.5rem 1rem',
                background: 'transparent',
                border: '1px solid rgba(148, 163, 184, 0.3)',
                borderRadius: '0.375rem',
                color: 'rgb(203, 213, 225)',
                cursor: 'pointer',
                fontSize: '0.875rem',
                fontWeight: '500'
              }
            }, 'Clear All')
          ),
          React.createElement('div', { style: { display: 'flex', gap: '0.75rem' } },
            React.createElement('button', {
              onClick: sendBulkReminders,
              style: {
                padding: '0.5rem 1.5rem',
                background: 'rgba(59, 130, 246, 0.2)',
                border: '1px solid rgb(59, 130, 246)',
                borderRadius: '0.375rem',
                color: 'rgb(147, 197, 253)',
                cursor: 'pointer',
                fontSize: '0.875rem',
                fontWeight: '500',
                display: 'flex',
                alignItems: 'center',
                gap: '0.5rem'
              }
            },
              React.createElement(Send, { size: 14 }),
              'Send Bulk Reminders'
            ),
            React.createElement('button', {
              onClick: () => {
                const utilsList = Array.from(selectedUtilities).map(id => 
                  utilities.find(u => u.id === id)?.name
                ).join(', ');
                alert(`Export Selected (${selectedUtilities.size})\n\n${utilsList}\n\nIn production, this would export only the selected utilities to CSV/PDF.`);
              },
              style: {
                padding: '0.5rem 1.5rem',
                background: 'transparent',
                border: '1px solid rgba(34, 197, 94, 0.3)',
                borderRadius: '0.375rem',
                color: 'rgb(134, 239, 172)',
                cursor: 'pointer',
                fontSize: '0.875rem',
                fontWeight: '500'
              }
            }, 'ðŸ“Š Export Selected')
          )
        ),

        // This Week View - simplified for HTML
        view === 'thisweek' && React.createElement('div', { style: { padding: '0 2rem 2rem' } },
          React.createElement('div', {
            style: {
              marginBottom: '1.5rem',
              padding: '1.5rem',
              background: 'rgba(34, 197, 94, 0.1)',
              border: '1px solid rgba(34, 197, 94, 0.3)',
              borderRadius: '0.75rem'
            }
          },
            React.createElement('div', { style: { display: 'flex', alignItems: 'center', gap: '0.75rem', marginBottom: '0.5rem' } },
              React.createElement(Clock, { size: 24, style: { color: 'rgb(134, 239, 172)' } }),
              React.createElement('h2', { style: { margin: 0, fontSize: '1.5rem', fontWeight: '700', color: 'rgb(134, 239, 172)' } }, 
                "This Week's Priorities"
              )
            ),
            React.createElement('p', { style: { margin: 0, fontSize: '0.875rem', color: 'rgb(203, 213, 225)' } },
              `${thisWeekUtilities.length} utilities with tasks due within 7 days or recently overdue`
            )
          ),
          React.createElement('div', { style: { display: 'flex', flexDirection: 'column', gap: '1rem' } },
            thisWeekUtilities.slice(0, 10).map(utility => {
              const urgentTasks = utility.tasks
                .filter(t => t.daysUntilDue <= 7 && t.daysUntilDue >= -2)
                .sort((a, b) => a.daysUntilDue - b.daysUntilDue);

              return React.createElement('div', {
                key: utility.id,
                style: {
                  background: 'rgba(30, 41, 59, 0.5)',
                  border: '1px solid rgba(148, 163, 184, 0.1)',
                  borderRadius: '0.75rem',
                  overflow: 'hidden'
                }
              },
                React.createElement('div', {
                  style: {
                    padding: '1.25rem',
                    background: 'rgba(15, 23, 42, 0.5)',
                    borderBottom: '1px solid rgba(148, 163, 184, 0.1)'
                  }
                },
                  React.createElement('h3', { style: { margin: '0 0 0.25rem 0', fontSize: '1.125rem', fontWeight: '600' } }, utility.name),
                  React.createElement('div', { style: { fontSize: '0.75rem', color: 'rgb(148, 163, 184)' } },
                    `${utility.city} â€¢ ${urgentTasks.length} task${urgentTasks.length !== 1 ? 's' : ''} due this week`
                  )
                ),
                React.createElement('div', { style: { padding: '1rem 1.25rem' } },
                  urgentTasks.slice(0, 3).map(task => 
                    React.createElement('div', {
                      key: task.id,
                      style: {
                        padding: '0.75rem',
                        background: task.daysUntilDue < 0 ? 'rgba(239, 68, 68, 0.1)' : 'rgba(251, 146, 60, 0.1)',
                        border: task.daysUntilDue < 0 ? '1px solid rgba(239, 68, 68, 0.3)' : '1px solid rgba(251, 146, 60, 0.3)',
                        borderRadius: '0.5rem',
                        marginBottom: '0.5rem'
                      }
                    },
                      React.createElement('div', { style: { fontWeight: '600', marginBottom: '0.25rem' } }, task.name),
                      React.createElement('div', { style: { fontSize: '0.75rem', color: 'rgb(148, 163, 184)' } },
                        `${task.assignedTo.name} â€¢ ${task.daysUntilDue < 0 ? `${Math.abs(task.daysUntilDue)}d overdue` : `Due in ${task.daysUntilDue}d`}`
                      ),
                      React.createElement('button', {
                        onClick: () => setEmailDraft(generateEmailDraft(utility, task)),
                        style: {
                          marginTop: '0.75rem',
                          padding: '0.5rem 1rem',
                          background: 'rgba(59, 130, 246, 0.2)',
                          border: '1px solid rgb(59, 130, 246)',
                          borderRadius: '0.375rem',
                          color: 'rgb(147, 197, 253)',
                          cursor: 'pointer',
                          fontSize: '0.875rem',
                          fontWeight: '500',
                          display: 'inline-flex',
                          alignItems: 'center',
                          gap: '0.5rem'
                        }
                      },
                        React.createElement(Send, { size: 14 }),
                        'Send Reminder'
                      )
                    )
                  )
                )
              );
            })
          )
        ),

        // Action Queue View
        view === 'queue' && React.createElement('div', { style: { padding: '0 2rem 2rem' } },
          // Filters
          React.createElement('div', {
            style: {
              display: 'flex',
              gap: '1rem',
              marginBottom: '1.5rem',
              flexWrap: 'wrap'
            }
          },
            React.createElement('div', { style: { position: 'relative', flex: '1', minWidth: '300px' } },
              React.createElement(Search, {
                size: 18,
                style: {
                  position: 'absolute',
                  left: '1rem',
                  top: '50%',
                  transform: 'translateY(-50%)',
                  color: 'rgb(148, 163, 184)'
                }
              }),
              React.createElement('input', {
                type: 'text',
                placeholder: 'Search utilities...',
                value: searchTerm,
                onChange: (e) => setSearchTerm(e.target.value),
                style: {
                  width: '100%',
                  padding: '0.75rem 1rem 0.75rem 3rem',
                  background: 'rgba(30, 41, 59, 0.5)',
                  border: '1px solid rgba(148, 163, 184, 0.2)',
                  borderRadius: '0.5rem',
                  color: 'rgb(248, 250, 252)',
                  fontSize: '0.875rem',
                  outline: 'none'
                }
              })
            ),
            
            React.createElement('select', {
              value: filterStatus,
              onChange: (e) => setFilterStatus(e.target.value),
              style: {
                padding: '0.75rem 1rem',
                background: 'rgba(30, 41, 59, 0.5)',
                border: '1px solid rgba(148, 163, 184, 0.2)',
                borderRadius: '0.5rem',
                color: 'rgb(248, 250, 252)',
                fontSize: '0.875rem',
                cursor: 'pointer'
              }
            },
              React.createElement('option', { value: 'all' }, 'All Status'),
              React.createElement('option', { value: 'critical' }, 'Critical'),
              React.createElement('option', { value: 'warning' }, 'Warning'),
              React.createElement('option', { value: 'healthy' }, 'Healthy')
            ),

            React.createElement('select', {
              value: filterCategory,
              onChange: (e) => setFilterCategory(e.target.value),
              style: {
                padding: '0.75rem 1rem',
                background: 'rgba(30, 41, 59, 0.5)',
                border: '1px solid rgba(148, 163, 184, 0.2)',
                borderRadius: '0.5rem',
                color: 'rgb(248, 250, 252)',
                fontSize: '0.875rem',
                cursor: 'pointer'
              }
            },
              React.createElement('option', { value: 'all' }, `All Tasks (${utilities.length})`),
              React.createElement('option', { value: 'blocker' }, `Blockers Only (${utilities.filter(u => u.tasks.some(t => t.category === 'blocker')).length})`),
              React.createElement('option', { value: 'disbursement-dependent' }, `Disbursement-Dependent (${utilities.filter(u => u.tasks.some(t => t.category === 'disbursement-dependent')).length})`),
              React.createElement('option', { value: 'compliance' }, `Compliance (${utilities.filter(u => u.tasks.some(t => t.category === 'compliance')).length})`),
              React.createElement('option', { value: 'operational' }, `Operational (${utilities.filter(u => u.tasks.some(t => t.category === 'operational')).length})`)
            ),

            React.createElement('select', {
              value: sortBy,
              onChange: (e) => setSortBy(e.target.value),
              style: {
                padding: '0.75rem 1rem',
                background: 'rgba(30, 41, 59, 0.5)',
                border: '1px solid rgba(148, 163, 184, 0.2)',
                borderRadius: '0.5rem',
                color: 'rgb(248, 250, 252)',
                fontSize: '0.875rem',
                cursor: 'pointer'
              }
            },
              React.createElement('option', { value: 'risk' }, 'Sort: Risk Score (High to Low)'),
              React.createElement('option', { value: 'deadline' }, 'Sort: Deadline (Soonest First)'),
              React.createElement('option', { value: 'activity' }, 'Sort: Last Activity (Oldest First)'),
              React.createElement('option', { value: 'name' }, 'Sort: Name (A-Z)')
            ),

            React.createElement('select', {
              value: filterAssignee,
              onChange: (e) => setFilterAssignee(e.target.value),
              style: {
                padding: '0.75rem 1rem',
                background: 'rgba(30, 41, 59, 0.5)',
                border: '1px solid rgba(148, 163, 184, 0.2)',
                borderRadius: '0.5rem',
                color: 'rgb(248, 250, 252)',
                fontSize: '0.875rem',
                cursor: 'pointer',
                minWidth: '200px'
              }
            },
              React.createElement('option', { value: 'all' }, 'ðŸ‘¥ All Team Members'),
              React.createElement('option', { value: 'unassigned' }, 'âš ï¸ Unassigned'),
              ...teamMembers.map(member => 
                React.createElement('option', { key: member.id, value: member.id.toString() }, 
                  `${member.avatar} ${member.name}`
                )
              )
            )
          ),

          // Utility List Table
          React.createElement('div', {
            style: {
              background: 'rgba(30, 41, 59, 0.5)',
              border: '1px solid rgba(148, 163, 184, 0.1)',
              borderRadius: '0.75rem',
              overflow: 'hidden'
            }
          },
            // Table Header
            React.createElement('div', {
              style: {
                display: 'grid',
                gridTemplateColumns: '0.5fr 2fr 1fr 1fr 1.5fr 1fr 1fr 0.5fr',
                padding: '1rem 1.5rem',
                background: 'rgba(15, 23, 42, 0.5)',
                borderBottom: '1px solid rgba(148, 163, 184, 0.1)',
                fontSize: '0.75rem',
                fontWeight: '600',
                textTransform: 'uppercase',
                letterSpacing: '0.05em',
                color: 'rgb(148, 163, 184)'
              }
            },
              React.createElement('div', { style: { display: 'flex', alignItems: 'center' } },
                React.createElement('input', {
                  type: 'checkbox',
                  checked: selectedUtilities.size === filteredUtilities.length && filteredUtilities.length > 0,
                  onChange: (e) => e.target.checked ? selectAllFiltered() : clearSelections(),
                  style: { cursor: 'pointer', width: '16px', height: '16px' }
                })
              ),
              React.createElement('div', null, 'Utility'),
              React.createElement('div', null, 'Health'),
              React.createElement('div', null, 'Last Activity'),
              React.createElement('div', null, 'Highest Priority Task'),
              React.createElement('div', null, 'Assignee'),
              React.createElement('div', null, 'Deadline'),
              React.createElement('div', null)
            ),

            // Table Rows
            filteredUtilities.map((utility, idx) => {
              const highestPriorityTask = utility.tasks.sort((a, b) => {
                if (a.category === 'blocker' && b.category !== 'blocker') return -1;
                if (a.category !== 'blocker' && b.category === 'blocker') return 1;
                return a.daysUntilDue - b.daysUntilDue;
              })[0];

              // Assign team member based on utility id hash (consistent across renders)
              const utilityHash = utility.id.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);
              const shouldHaveAssignee = utilityHash % 4 !== 0; // 75% have assignees
              const assignedMember = shouldHaveAssignee ? teamMembers[utilityHash % teamMembers.length] : null;

              return React.createElement('div', {
                key: utility.id,
                style: {
                  display: 'grid',
                  gridTemplateColumns: '0.5fr 2fr 1fr 1fr 1.5fr 1fr 1fr 0.5fr',
                  padding: '1.25rem 1.5rem',
                  borderBottom: idx < filteredUtilities.length - 1 ? '1px solid rgba(148, 163, 184, 0.05)' : 'none',
                  transition: 'all 0.2s',
                  alignItems: 'center',
                  background: selectedUtilities.has(utility.id) ? 'rgba(59, 130, 246, 0.1)' : 'transparent'
                },
                onMouseEnter: (e) => {
                  if (!selectedUtilities.has(utility.id)) {
                    e.currentTarget.style.background = 'rgba(59, 130, 246, 0.05)';
                  }
                },
                onMouseLeave: (e) => {
                  if (!selectedUtilities.has(utility.id)) {
                    e.currentTarget.style.background = 'transparent';
                  }
                }
              },
                // Checkbox Column
                React.createElement('div', {
                  onClick: (e) => e.stopPropagation(),
                  style: { display: 'flex', alignItems: 'center' }
                },
                  React.createElement('input', {
                    type: 'checkbox',
                    checked: selectedUtilities.has(utility.id),
                    onChange: () => toggleUtilitySelection(utility.id),
                    style: { cursor: 'pointer', width: '16px', height: '16px' }
                  })
                ),
                // Utility Name Column
                React.createElement('div', {
                  onClick: () => setSelectedUtility(utility),
                  style: { cursor: 'pointer' }
                },
                  React.createElement('div', { style: { fontWeight: '600', marginBottom: '0.25rem' } }, utility.name),
                  React.createElement('div', { style: { fontSize: '0.75rem', color: 'rgb(148, 163, 184)' } },
                    `${utility.city} â€¢ ${utility.customerCount.toLocaleString()} customers`,
                    utility.isHighTouch && React.createElement('span', {
                      style: {
                        marginLeft: '0.5rem',
                        padding: '0.125rem 0.5rem',
                        background: 'rgba(147, 51, 234, 0.2)',
                        color: 'rgb(192, 132, 252)',
                        borderRadius: '0.25rem',
                        fontSize: '0.625rem',
                        fontWeight: '600'
                      }
                    }, 'HIGH-TOUCH')
                  )
                ),

                // Health Status Column
                React.createElement('div', { style: { display: 'flex', alignItems: 'center', gap: '0.5rem' } },
                  React.createElement('div', {
                    style: {
                      width: '8px',
                      height: '8px',
                      borderRadius: '50%',
                      background: getStatusColor(utility.healthStatus),
                      boxShadow: `0 0 8px ${getStatusColor(utility.healthStatus)}`
                    }
                  }),
                  React.createElement('span', {
                    style: {
                      fontSize: '0.875rem',
                      fontWeight: '600',
                      color: getStatusColor(utility.healthStatus),
                      textTransform: 'capitalize'
                    }
                  }, utility.healthStatus),
                  React.createElement('span', {
                    style: {
                      fontSize: '0.75rem',
                      color: 'rgb(148, 163, 184)',
                      marginLeft: '0.25rem'
                    }
                  }, `(${utility.riskScore})`)
                ),

                // Last Activity Column
                React.createElement('div', {
                  style: { fontSize: '0.875rem', color: 'rgb(203, 213, 225)' }
                }, `${utility.lastActivity} days ago`),

                // Highest Priority Task Column
                highestPriorityTask && React.createElement('div', null,
                  React.createElement('div', {
                    style: {
                      display: 'inline-block',
                      padding: '0.25rem 0.5rem',
                      background: `${getCategoryColor(highestPriorityTask.category)}15`,
                      color: getCategoryColor(highestPriorityTask.category),
                      borderRadius: '0.25rem',
                      fontSize: '0.625rem',
                      fontWeight: '700',
                      textTransform: 'uppercase',
                      letterSpacing: '0.05em',
                      marginBottom: '0.25rem'
                    }
                  }, highestPriorityTask.category),
                  React.createElement('div', {
                    style: { fontSize: '0.875rem', color: 'rgb(203, 213, 225)' }
                  }, highestPriorityTask.name)
                ),

                // Assignee Column
                assignedMember ? React.createElement('div', {
                  style: { 
                    display: 'flex', 
                    alignItems: 'center', 
                    gap: '0.75rem',
                    cursor: 'pointer',
                    padding: '0.5rem',
                    borderRadius: '0.5rem',
                    transition: 'all 0.2s'
                  },
                  onClick: (e) => {
                    e.stopPropagation();
                    alert(`Reassign Utility\n\nIn production, this would:\nâ€¢ Show team member selector\nâ€¢ Allow reassignment to different person\nâ€¢ Update workload distribution\n\nCurrently assigned to: ${assignedMember.name}`);
                  },
                  onMouseEnter: (e) => {
                    e.currentTarget.style.background = `${assignedMember.color}15`;
                  },
                  onMouseLeave: (e) => {
                    e.currentTarget.style.background = 'transparent';
                  }
                },
                  React.createElement('div', {
                    style: {
                      fontSize: '1.5rem',
                      width: '40px',
                      height: '40px',
                      display: 'flex',
                      alignItems: 'center',
                      justifyContent: 'center',
                      background: `${assignedMember.color}25`,
                      borderRadius: '50%',
                      border: `2px solid ${assignedMember.color}`,
                      flexShrink: 0
                    }
                  }, assignedMember.avatar),
                  React.createElement('div', null,
                    React.createElement('div', {
                      style: { 
                        fontSize: '0.875rem', 
                        fontWeight: '600',
                        color: assignedMember.color,
                        marginBottom: '0.125rem'
                      }
                    }, assignedMember.name),
                    React.createElement('div', {
                      style: { 
                        fontSize: '0.625rem', 
                        color: 'rgb(148, 163, 184)',
                        textTransform: 'uppercase',
                        letterSpacing: '0.05em'
                      }
                    }, assignedMember.role)
                  )
                ) : React.createElement('div', {
                  style: {
                    cursor: 'pointer',
                    padding: '0.75rem 1rem',
                    borderRadius: '0.5rem',
                    border: '2px dashed rgba(251, 146, 60, 0.4)',
                    fontSize: '0.875rem',
                    color: 'rgb(251, 146, 60)',
                    textAlign: 'center',
                    fontWeight: '600',
                    transition: 'all 0.2s',
                    background: 'rgba(251, 146, 60, 0.05)'
                  },
                  onClick: (e) => {
                    e.stopPropagation();
                    alert('Assign Utility\n\nIn production, this would:\nâ€¢ Show team member selector\nâ€¢ Assign to selected person\nâ€¢ Update their workload\nâ€¢ Send notification');
                  },
                  onMouseEnter: (e) => {
                    e.currentTarget.style.background = 'rgba(251, 146, 60, 0.15)';
                    e.currentTarget.style.borderColor = 'rgba(251, 146, 60, 0.6)';
                  },
                  onMouseLeave: (e) => {
                    e.currentTarget.style.background = 'rgba(251, 146, 60, 0.05)';
                    e.currentTarget.style.borderColor = 'rgba(251, 146, 60, 0.4)';
                  }
                }, 'âš ï¸ Unassigned'),

                // Deadline Column
                React.createElement('div', {
                  style: {
                    fontSize: '0.875rem',
                    fontWeight: '600',
                    color: utility.nextDeadline < 0 ? 'rgb(239, 68, 68)' : 
                           utility.nextDeadline < 3 ? 'rgb(251, 146, 60)' : 'rgb(203, 213, 225)'
                  }
                },
                  utility.nextDeadline < 0 ? `${Math.abs(utility.nextDeadline)}d overdue` :
                  utility.nextDeadline === 0 ? 'Today' :
                  `${utility.nextDeadline}d`
                ),

                // Arrow Column
                React.createElement('div', { style: { display: 'flex', justifyContent: 'flex-end' } },
                  React.createElement(ChevronRight, { size: 20, style: { color: 'rgb(148, 163, 184)' } })
                )
              );
            })
          )
        ),
        view === 'analytics' && React.createElement('div', { style: { padding: '0 2rem 2rem' } },
          // Analytics Sub-Navigation
          React.createElement('div', {
            style: {
              marginBottom: '2rem',
              display: 'flex',
              gap: '1rem',
              borderBottom: '1px solid rgba(148, 163, 184, 0.2)',
              paddingBottom: '1rem'
            }
          },
            ['executive', 'health', 'team', 'detail'].map(subView => {
              const labels = {
                executive: 'ðŸ“Š Executive Summary',
                health: 'ðŸ¥ Program Health',
                team: 'ðŸ‘¥ Team Performance',
                detail: 'ðŸ” Deep Dive'
              };
              
              return React.createElement('button', {
                key: subView,
                onClick: () => setAnalyticsView(subView),
                style: {
                  padding: '0.75rem 1.5rem',
                  background: analyticsView === subView ? 'rgba(59, 130, 246, 0.2)' : 'transparent',
                  border: analyticsView === subView ? '1px solid rgb(59, 130, 246)' : '1px solid rgba(148, 163, 184, 0.2)',
                  borderRadius: '0.5rem',
                  color: analyticsView === subView ? 'rgb(147, 197, 253)' : 'rgb(203, 213, 225)',
                  cursor: 'pointer',
                  fontSize: '0.875rem',
                  fontWeight: '500',
                  transition: 'all 0.2s'
                }
              }, labels[subView]);
            })
          ),

          // Executive Summary View
          analyticsView === 'executive' && React.createElement('div', null,
            React.createElement('div', {
              style: {
                marginBottom: '2rem',
                padding: '1.5rem',
                background: 'linear-gradient(135deg, rgba(59, 130, 246, 0.15) 0%, rgba(147, 51, 234, 0.15) 100%)',
                border: '1px solid rgba(59, 130, 246, 0.3)',
                borderRadius: '0.75rem'
              }
            },
              React.createElement('h2', {
                style: { margin: '0 0 0.5rem 0', fontSize: '1.75rem', fontWeight: '700', color: 'rgb(147, 197, 253)' }
              }, 'ðŸ“Š Executive Summary'),
              React.createElement('p', {
                style: { margin: 0, fontSize: '0.875rem', color: 'rgb(203, 213, 225)' }
              }, `Program Status as of ${new Date().toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' })}`)
            ),

            // Key Metrics (3 columns)
            React.createElement('div', {
              style: {
                display: 'grid',
                gridTemplateColumns: 'repeat(3, 1fr)',
                gap: '1.5rem',
                marginBottom: '2rem'
              }
            },
              React.createElement('div', {
                style: {
                  padding: '1.5rem',
                  background: 'rgba(30, 41, 59, 0.5)',
                  border: '1px solid rgba(34, 197, 94, 0.3)',
                  borderRadius: '0.75rem'
                }
              },
                React.createElement('div', {
                  style: { fontSize: '0.75rem', color: 'rgb(148, 163, 184)', textTransform: 'uppercase', letterSpacing: '0.05em', marginBottom: '0.5rem' }
                }, 'Program Participation'),
                React.createElement('div', {
                  style: { fontSize: '2.5rem', fontWeight: '700', color: 'rgb(34, 197, 94)', marginBottom: '0.5rem' }
                }, '60'),
                React.createElement('div', {
                  style: { fontSize: '0.875rem', color: 'rgb(203, 213, 225)' }
                }, 'Active Utilities'),
                React.createElement('div', {
                  style: { fontSize: '0.75rem', color: 'rgb(148, 163, 184)', marginTop: '0.5rem' }
                }, `${utilities.reduce((sum, u) => sum + u.customerCount, 0).toLocaleString()} customers served`)
              ),

              React.createElement('div', {
                style: {
                  padding: '1.5rem',
                  background: 'rgba(30, 41, 59, 0.5)',
                  border: '1px solid rgba(34, 197, 94, 0.3)',
                  borderRadius: '0.75rem'
                }
              },
                React.createElement('div', {
                  style: { fontSize: '0.75rem', color: 'rgb(148, 163, 184)', textTransform: 'uppercase', letterSpacing: '0.05em', marginBottom: '0.5rem' }
                }, 'Healthy Utilities'),
                React.createElement('div', {
                  style: { fontSize: '2.5rem', fontWeight: '700', color: 'rgb(34, 197, 94)', marginBottom: '0.5rem' }
                }, utilities.filter(u => u.healthStatus === 'healthy').length),
                React.createElement('div', {
                  style: { fontSize: '0.875rem', color: 'rgb(203, 213, 225)' }
                }, 'No critical issues'),
                React.createElement('div', {
                  style: { fontSize: '0.75rem', color: 'rgb(148, 163, 184)', marginTop: '0.5rem' }
                }, `${Math.round((utilities.filter(u => u.healthStatus === 'healthy').length / utilities.length) * 100)}% of total`)
              ),

              React.createElement('div', {
                style: {
                  padding: '1.5rem',
                  background: 'rgba(30, 41, 59, 0.5)',
                  border: '1px solid rgba(239, 68, 68, 0.3)',
                  borderRadius: '0.75rem'
                }
              },
                React.createElement('div', {
                  style: { fontSize: '0.75rem', color: 'rgb(148, 163, 184)', textTransform: 'uppercase', letterSpacing: '0.05em', marginBottom: '0.5rem' }
                }, 'Critical Utilities'),
                React.createElement('div', {
                  style: { fontSize: '2.5rem', fontWeight: '700', color: 'rgb(239, 68, 68)', marginBottom: '0.5rem' }
                }, utilities.filter(u => u.healthStatus === 'critical').length),
                React.createElement('div', {
                  style: { fontSize: '0.875rem', color: 'rgb(203, 213, 225)' }
                }, 'Need immediate action'),
                React.createElement('div', {
                  style: { fontSize: '0.75rem', color: 'rgb(148, 163, 184)', marginTop: '0.5rem' }
                }, `~$${(utilities.filter(u => u.healthStatus === 'critical').length * 125).toLocaleString()}K at risk`)
              )
            ),

            // Key Insights
            React.createElement('div', {
              style: {
                background: 'linear-gradient(135deg, rgba(147, 51, 234, 0.15) 0%, rgba(236, 72, 153, 0.15) 100%)',
                border: '1px solid rgba(147, 51, 234, 0.3)',
                borderRadius: '0.75rem',
                padding: '1.5rem'
              }
            },
              React.createElement('h3', {
                style: { margin: '0 0 1rem 0', fontSize: '1.125rem', fontWeight: '600', color: 'rgb(192, 132, 252)' }
              }, 'ðŸ’¡ Key Insights'),
              React.createElement('div', {
                style: { display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '1rem' }
              },
                [
                  {
                    title: 'Program Health',
                    insight: `${utilities.filter(u => u.healthStatus === 'healthy').length} healthy, ${utilities.filter(u => u.healthStatus === 'warning').length} at risk, ${utilities.filter(u => u.healthStatus === 'critical').length} critical`,
                    status: 'positive'
                  },
                  {
                    title: 'Critical Attention',
                    insight: `${utilities.filter(u => u.healthStatus === 'critical').length} utilities need immediate intervention`,
                    status: 'urgent'
                  },
                  {
                    title: 'Team Capacity',
                    insight: 'Workload evenly distributed across all team members',
                    status: 'positive'
                  },
                  {
                    title: 'Compliance Risk',
                    insight: `${utilities.filter(u => u.tasks.some(t => t.category === 'compliance' && t.status === 'overdue')).length} overdue compliance tasks`,
                    status: 'warning'
                  }
                ].map((item, idx) =>
                  React.createElement('div', {
                    key: idx,
                    style: {
                      padding: '1rem',
                      background: 'rgba(30, 41, 59, 0.5)',
                      border: `1px solid ${item.status === 'positive' ? 'rgba(34, 197, 94, 0.3)' : item.status === 'urgent' ? 'rgba(239, 68, 68, 0.3)' : 'rgba(251, 146, 60, 0.3)'}`,
                      borderRadius: '0.5rem'
                    }
                  },
                    React.createElement('div', {
                      style: {
                        fontSize: '0.875rem',
                        fontWeight: '600',
                        color: item.status === 'positive' ? 'rgb(34, 197, 94)' : item.status === 'urgent' ? 'rgb(239, 68, 68)' : 'rgb(251, 146, 60)',
                        marginBottom: '0.5rem'
                      }
                    }, item.title),
                    React.createElement('div', {
                      style: { fontSize: '0.875rem', color: 'rgb(203, 213, 225)' }
                    }, item.insight)
                  )
                )
              )
            )
          ),

          // Program Health View
          analyticsView === 'health' && React.createElement('div', null,
            React.createElement('h2', {
              style: { margin: '0 0 1.5rem 0', fontSize: '1.75rem', fontWeight: '700' }
            }, 'ðŸ¥ Program Health Overview'),

            // Heatmap
            React.createElement('div', {
              style: {
                background: 'rgba(30, 41, 59, 0.5)',
                border: '1px solid rgba(148, 163, 184, 0.1)',
                borderRadius: '0.75rem',
                overflow: 'hidden',
                marginBottom: '2rem'
              }
            },
              React.createElement('div', {
                style: {
                  padding: '1.25rem 1.5rem',
                  background: 'rgba(15, 23, 42, 0.5)',
                  borderBottom: '1px solid rgba(148, 163, 184, 0.1)',
                  display: 'flex',
                  justifyContent: 'space-between',
                  alignItems: 'center'
                }
              },
                React.createElement('div', null,
                  React.createElement('h3', {
                    style: { margin: '0 0 0.25rem 0', fontSize: '1rem', fontWeight: '600' }
                  }, 'ðŸ—ºï¸ All Utilities Heatmap'),
                  React.createElement('p', {
                    style: { margin: 0, fontSize: '0.75rem', color: 'rgb(148, 163, 184)' }
                  }, 'Click any tile for details')
                ),
                React.createElement('div', { style: { display: 'flex', gap: '1rem', fontSize: '0.75rem' } },
                  React.createElement('div', { style: { display: 'flex', alignItems: 'center', gap: '0.5rem' } },
                    React.createElement('div', {
                      style: { width: '12px', height: '12px', background: 'rgb(239, 68, 68)', borderRadius: '2px' }
                    }),
                    React.createElement('span', { style: { color: 'rgb(148, 163, 184)' } }, 'Critical')
                  ),
                  React.createElement('div', { style: { display: 'flex', alignItems: 'center', gap: '0.5rem' } },
                    React.createElement('div', {
                      style: { width: '12px', height: '12px', background: 'rgb(251, 146, 60)', borderRadius: '2px' }
                    }),
                    React.createElement('span', { style: { color: 'rgb(148, 163, 184)' } }, 'At Risk')
                  ),
                  React.createElement('div', { style: { display: 'flex', alignItems: 'center', gap: '0.5rem' } },
                    React.createElement('div', {
                      style: { width: '12px', height: '12px', background: 'rgb(34, 197, 94)', borderRadius: '2px' }
                    }),
                    React.createElement('span', { style: { color: 'rgb(148, 163, 184)' } }, 'Healthy')
                  )
                )
              ),
              React.createElement('div', {
                style: {
                  padding: '1.5rem',
                  display: 'grid',
                  gridTemplateColumns: 'repeat(10, 1fr)',
                  gap: '0.5rem'
                }
              },
                utilities.map(utility => 
                  React.createElement('div', {
                    key: utility.id,
                    onClick: () => setSelectedUtility(utility),
                    title: `${utility.name} - ${utility.healthStatus}`,
                    style: {
                      aspectRatio: '1',
                      background: getStatusColor(utility.healthStatus),
                      borderRadius: '0.25rem',
                      cursor: 'pointer',
                      transition: 'all 0.2s',
                      border: '1px solid rgba(0, 0, 0, 0.2)'
                    },
                    onMouseEnter: (e) => {
                      e.currentTarget.style.transform = 'scale(1.2)';
                      e.currentTarget.style.zIndex = '10';
                      e.currentTarget.style.boxShadow = `0 0 12px ${getStatusColor(utility.healthStatus)}`;
                    },
                    onMouseLeave: (e) => {
                      e.currentTarget.style.transform = 'scale(1)';
                      e.currentTarget.style.zIndex = '1';
                      e.currentTarget.style.boxShadow = 'none';
                    }
                  })
                )
              )
            ),

            // Critical & At-Risk
            React.createElement('div', {
              style: { display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '1.5rem' }
            },
              React.createElement('div', {
                style: {
                  background: 'rgba(30, 41, 59, 0.5)',
                  border: '1px solid rgba(239, 68, 68, 0.3)',
                  borderRadius: '0.75rem',
                  padding: '1.5rem'
                }
              },
                React.createElement('h3', {
                  style: { margin: '0 0 1rem 0', fontSize: '1rem', fontWeight: '600', color: 'rgb(239, 68, 68)' }
                }, `ðŸš¨ Critical (${utilities.filter(u => u.healthStatus === 'critical').length})`),
                utilities.filter(u => u.healthStatus === 'critical').slice(0, 5).map(u =>
                  React.createElement('div', {
                    key: u.id,
                    onClick: () => setSelectedUtility(u),
                    style: {
                      padding: '0.75rem',
                      background: 'rgba(239, 68, 68, 0.1)',
                      border: '1px solid rgba(239, 68, 68, 0.2)',
                      borderRadius: '0.5rem',
                      marginBottom: '0.5rem',
                      cursor: 'pointer'
                    }
                  },
                    React.createElement('div', {
                      style: { fontWeight: '600', marginBottom: '0.25rem' }
                    }, u.name),
                    React.createElement('div', {
                      style: { fontSize: '0.75rem', color: 'rgb(148, 163, 184)' }
                    }, `Risk: ${u.riskScore} â€¢ ${u.city}`)
                  )
                )
              ),

              React.createElement('div', {
                style: {
                  background: 'rgba(30, 41, 59, 0.5)',
                  border: '1px solid rgba(251, 146, 60, 0.3)',
                  borderRadius: '0.75rem',
                  padding: '1.5rem'
                }
              },
                React.createElement('h3', {
                  style: { margin: '0 0 1rem 0', fontSize: '1rem', fontWeight: '600', color: 'rgb(251, 146, 60)' }
                }, `âš ï¸ At Risk (${utilities.filter(u => u.healthStatus === 'warning').length})`),
                utilities.filter(u => u.healthStatus === 'warning').slice(0, 5).map(u =>
                  React.createElement('div', {
                    key: u.id,
                    onClick: () => setSelectedUtility(u),
                    style: {
                      padding: '0.75rem',
                      background: 'rgba(251, 146, 60, 0.1)',
                      border: '1px solid rgba(251, 146, 60, 0.2)',
                      borderRadius: '0.5rem',
                      marginBottom: '0.5rem',
                      cursor: 'pointer'
                    }
                  },
                    React.createElement('div', {
                      style: { fontWeight: '600', marginBottom: '0.25rem' }
                    }, u.name),
                    React.createElement('div', {
                      style: { fontSize: '0.75rem', color: 'rgb(148, 163, 184)' }
                    }, `Risk: ${u.riskScore} â€¢ ${u.city}`)
                  )
                )
              )
            )
          ),

          // Team Performance View
          analyticsView === 'team' && React.createElement('div', null,
            React.createElement('h2', {
              style: { margin: '0 0 1.5rem 0', fontSize: '1.75rem', fontWeight: '700' }
            }, 'ðŸ‘¥ Team Performance'),

            React.createElement('div', {
              style: {
                display: 'grid',
                gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))',
                gap: '1.5rem'
              }
            },
              teamMembers.map(member => {
                const memberTasks = utilities.flatMap(u => 
                  u.tasks.filter(t => {
                    const hash = (u.id + t.id).split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);
                    return hash % teamMembers.length === (member.id - 1);
                  })
                );
                const overdueCount = memberTasks.filter(t => t.status === 'overdue').length;

                return React.createElement('div', {
                  key: member.id,
                  style: {
                    background: 'rgba(30, 41, 59, 0.5)',
                    border: `1px solid ${member.color}30`,
                    borderRadius: '0.75rem',
                    padding: '1.5rem'
                  }
                },
                  React.createElement('div', {
                    style: { display: 'flex', alignItems: 'center', gap: '0.75rem', marginBottom: '1rem' }
                  },
                    React.createElement('div', {
                      style: {
                        fontSize: '2rem',
                        width: '48px',
                        height: '48px',
                        display: 'flex',
                        alignItems: 'center',
                        justifyContent: 'center',
                        background: `${member.color}20`,
                        borderRadius: '50%',
                        border: `2px solid ${member.color}`
                      }
                    }, member.avatar),
                    React.createElement('div', null,
                      React.createElement('div', {
                        style: { fontSize: '1.125rem', fontWeight: '600', color: member.color }
                      }, member.name),
                      React.createElement('div', {
                        style: { fontSize: '0.75rem', color: 'rgb(148, 163, 184)' }
                      }, member.role)
                    )
                  ),
                  React.createElement('div', {
                    style: {
                      display: 'grid',
                      gridTemplateColumns: 'repeat(2, 1fr)',
                      gap: '1rem',
                      marginBottom: '1rem'
                    }
                  },
                    React.createElement('div', {
                      style: {
                        padding: '0.75rem',
                        background: 'rgba(15, 23, 42, 0.5)',
                        borderRadius: '0.5rem',
                        textAlign: 'center'
                      }
                    },
                      React.createElement('div', {
                        style: { fontSize: '1.5rem', fontWeight: '700', color: member.color }
                      }, memberTasks.length),
                      React.createElement('div', {
                        style: { fontSize: '0.75rem', color: 'rgb(148, 163, 184)', marginTop: '0.25rem' }
                      }, 'Total Tasks')
                    ),
                    React.createElement('div', {
                      style: {
                        padding: '0.75rem',
                        background: 'rgba(15, 23, 42, 0.5)',
                        borderRadius: '0.5rem',
                        textAlign: 'center'
                      }
                    },
                      React.createElement('div', {
                        style: { fontSize: '1.5rem', fontWeight: '700', color: overdueCount > 0 ? 'rgb(239, 68, 68)' : 'rgb(34, 197, 94)' }
                      }, overdueCount),
                      React.createElement('div', {
                        style: { fontSize: '0.75rem', color: 'rgb(148, 163, 184)', marginTop: '0.25rem' }
                      }, 'Overdue')
                    )
                  ),
                  React.createElement('button', {
                    onClick: () => {
                      setView('team');
                    },
                    style: {
                      width: '100%',
                      padding: '0.75rem',
                      background: `${member.color}20`,
                      border: `1px solid ${member.color}`,
                      borderRadius: '0.5rem',
                      color: member.color,
                      cursor: 'pointer',
                      fontSize: '0.875rem',
                      fontWeight: '500'
                    }
                  }, 'View All Tasks â†’')
                );
              })
            )
          ),

          // Deep Dive View
          analyticsView === 'detail' && React.createElement('div', null,
            React.createElement('h2', {
              style: { margin: '0 0 1.5rem 0', fontSize: '1.75rem', fontWeight: '700' }
            }, 'ðŸ” Deep Dive Analysis'),

            // Search
            React.createElement('div', {
              style: {
                marginBottom: '2rem',
                position: 'relative'
              }
            },
              React.createElement(Search, {
                size: 20,
                style: {
                  position: 'absolute',
                  left: '1rem',
                  top: '50%',
                  transform: 'translateY(-50%)',
                  color: 'rgb(148, 163, 184)',
                  zIndex: 10
                }
              }),
              React.createElement('input', {
                type: 'text',
                placeholder: 'Search for a utility by name or city...',
                value: searchTerm,
                onChange: (e) => setSearchTerm(e.target.value),
                style: {
                  width: '100%',
                  padding: '1rem 1rem 1rem 3rem',
                  background: 'rgba(30, 41, 59, 0.5)',
                  border: '1px solid rgba(148, 163, 184, 0.2)',
                  borderRadius: '0.5rem',
                  color: 'rgb(248, 250, 252)',
                  fontSize: '1rem',
                  outline: 'none'
                }
              }),
              searchTerm && React.createElement('button', {
                onClick: () => setSearchTerm(''),
                style: {
                  position: 'absolute',
                  right: '1rem',
                  top: '50%',
                  transform: 'translateY(-50%)',
                  background: 'transparent',
                  border: 'none',
                  color: 'rgb(148, 163, 184)',
                  cursor: 'pointer',
                  fontSize: '1.25rem',
                  padding: '0.25rem',
                  zIndex: 10
                }
              }, 'Ã—')
            ),

            // Search Results
            searchTerm && filteredUtilities.length > 0 && React.createElement('div', {
              style: {
                marginBottom: '2rem',
                background: 'rgba(30, 41, 59, 0.5)',
                border: '1px solid rgba(148, 163, 184, 0.1)',
                borderRadius: '0.75rem',
                overflow: 'hidden'
              }
            },
              React.createElement('div', {
                style: {
                  padding: '1rem 1.5rem',
                  background: 'rgba(15, 23, 42, 0.5)',
                  borderBottom: '1px solid rgba(148, 163, 184, 0.1)'
                }
              },
                React.createElement('h3', {
                  style: { margin: 0, fontSize: '1rem', fontWeight: '600' }
                }, `Search Results (${filteredUtilities.length})`)
              ),
              React.createElement('div', { style: { padding: '1rem' } },
                filteredUtilities.map(utility =>
                  React.createElement('div', {
                    key: utility.id,
                    onClick: () => setSelectedUtility(utility),
                    style: {
                      background: 'rgba(15, 23, 42, 0.5)',
                      border: '1px solid rgba(148, 163, 184, 0.1)',
                      borderRadius: '0.5rem',
                      padding: '1rem',
                      marginBottom: '0.75rem',
                      cursor: 'pointer',
                      display: 'flex',
                      justifyContent: 'space-between',
                      alignItems: 'center'
                    }
                  },
                    React.createElement('div', null,
                      React.createElement('div', {
                        style: { fontWeight: '600', fontSize: '1rem', marginBottom: '0.25rem' }
                      }, utility.name),
                      React.createElement('div', {
                        style: { fontSize: '0.875rem', color: 'rgb(148, 163, 184)' }
                      }, `${utility.city} â€¢ ${utility.tasks.length} active tasks â€¢ Risk: ${utility.riskScore}`)
                    ),
                    React.createElement(ChevronRight, { size: 20, style: { color: 'rgb(148, 163, 184)' } })
                  )
                )
              )
            ),

            // Charts
            React.createElement('div', {
              style: {
                display: 'grid',
                gridTemplateColumns: '1fr 1fr',
                gap: '1.5rem'
              }
            },
              React.createElement('div', {
                style: {
                  background: 'rgba(30, 41, 59, 0.5)',
                  border: '1px solid rgba(148, 163, 184, 0.1)',
                  borderRadius: '0.75rem',
                  overflow: 'hidden'
                }
              },
                React.createElement('div', {
                  style: {
                    padding: '1.25rem',
                    background: 'rgba(15, 23, 42, 0.5)',
                    borderBottom: '1px solid rgba(148, 163, 184, 0.1)'
                  }
                },
                  React.createElement('h3', {
                    style: { margin: 0, fontSize: '1rem', fontWeight: '600' }
                  }, 'Task Distribution')
                ),
                React.createElement('div', { style: { padding: '1.5rem' } },
                  ['blocker', 'disbursement-dependent', 'compliance', 'operational'].map(category => {
                    const count = utilities.reduce((sum, u) => 
                      sum + u.tasks.filter(t => t.category === category).length, 0
                    );
                    const total = utilities.reduce((sum, u) => sum + u.tasks.length, 0);
                    const percentage = ((count / total) * 100).toFixed(1);
                    
                    return React.createElement('div', {
                      key: category,
                      style: { marginBottom: '1.25rem' }
                    },
                      React.createElement('div', {
                        style: {
                          display: 'flex',
                          justifyContent: 'space-between',
                          marginBottom: '0.5rem',
                          fontSize: '0.875rem'
                        }
                      },
                        React.createElement('span', {
                          style: { textTransform: 'capitalize', color: 'rgb(203, 213, 225)', fontWeight: '500' }
                        }, category.replace('-', ' ')),
                        React.createElement('span', {
                          style: { color: getCategoryColor(category), fontWeight: '600' }
                        }, `${count} (${percentage}%)`)
                      ),
                      React.createElement('div', {
                        style: {
                          height: '10px',
                          background: 'rgba(30, 41, 59, 0.5)',
                          borderRadius: '5px',
                          overflow: 'hidden'
                        }
                      },
                        React.createElement('div', {
                          style: {
                            height: '100%',
                            width: `${percentage}%`,
                            background: getCategoryColor(category),
                            transition: 'width 0.5s ease',
                            borderRadius: '5px'
                          }
                        })
                      )
                    );
                  })
                )
              ),

              React.createElement('div', {
                style: {
                  background: 'rgba(30, 41, 59, 0.5)',
                  border: '1px solid rgba(148, 163, 184, 0.1)',
                  borderRadius: '0.75rem',
                  overflow: 'hidden'
                }
              },
                React.createElement('div', {
                  style: {
                    padding: '1.25rem',
                    background: 'rgba(15, 23, 42, 0.5)',
                    borderBottom: '1px solid rgba(148, 163, 184, 0.1)'
                  }
                },
                  React.createElement('h3', {
                    style: { margin: 0, fontSize: '1rem', fontWeight: '600' }
                  }, 'Health Status')
                ),
                React.createElement('div', { style: { padding: '1.5rem' } },
                  [
                    { status: 'critical', label: 'Critical', color: 'rgb(239, 68, 68)' },
                    { status: 'warning', label: 'At Risk', color: 'rgb(251, 146, 60)' },
                    { status: 'healthy', label: 'Healthy', color: 'rgb(34, 197, 94)' }
                  ].map(({ status, label, color }) => {
                    const count = utilities.filter(u => u.healthStatus === status).length;
                    const percentage = ((count / utilities.length) * 100).toFixed(1);
                    
                    return React.createElement('div', {
                      key: status,
                      style: { marginBottom: '1.25rem' }
                    },
                      React.createElement('div', {
                        style: {
                          display: 'flex',
                          justifyContent: 'space-between',
                          marginBottom: '0.5rem',
                          fontSize: '0.875rem'
                        }
                      },
                        React.createElement('span', {
                          style: { color: 'rgb(203, 213, 225)', fontWeight: '500' }
                        }, label),
                        React.createElement('span', {
                          style: { color, fontWeight: '600' }
                        }, `${count} (${percentage}%)`)
                      ),
                      React.createElement('div', {
                        style: {
                          height: '10px',
                          background: 'rgba(30, 41, 59, 0.5)',
                          borderRadius: '5px',
                          overflow: 'hidden'
                        }
                      },
                        React.createElement('div', {
                          style: {
                            height: '100%',
                            width: `${percentage}%`,
                            background: color,
                            transition: 'width 0.5s ease',
                            borderRadius: '5px'
                          }
                        })
                      )
                    );
                  })
                )
              )
            )
          )
        ),
        view === 'team' && React.createElement('div', { style: { padding: '0 2rem 2rem' } },
          React.createElement('div', {
            style: {
              marginBottom: '2rem',
              padding: '1.5rem',
              background: 'rgba(147, 51, 234, 0.1)',
              border: '1px solid rgba(147, 51, 234, 0.3)',
              borderRadius: '0.75rem'
            }
          },
            React.createElement('h2', {
              style: { margin: '0 0 0.5rem 0', fontSize: '1.5rem', fontWeight: '700', color: 'rgb(192, 132, 252)' }
            }, 'ðŸ‘¥ Team Workload'),
            React.createElement('p', {
              style: { margin: 0, fontSize: '0.875rem', color: 'rgb(203, 213, 225)' }
            }, 'See who is assigned to which tasks and their current workload')
          ),

          React.createElement('div', {
            style: {
              display: 'grid',
              gridTemplateColumns: 'repeat(auto-fit, minmax(350px, 1fr))',
              gap: '1.5rem'
            }
          },
            teamMembers.map(member => {
              // Randomly assign some tasks to team members for demo
              const memberTasks = utilities.flatMap(u => 
                u.tasks
                  .filter(t => {
                    // Assign tasks based on member id for consistent demo
                    const hash = (u.id + t.id).split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);
                    return hash % teamMembers.length === (member.id - 1);
                  })
                  .map(t => ({ ...t, utility: u }))
              ).slice(0, 8); // Limit to 8 tasks per person

              const overdueCount = memberTasks.filter(t => t.status === 'overdue').length;
              const urgentCount = memberTasks.filter(t => t.status === 'urgent').length;

              return React.createElement('div', {
                key: member.id,
                style: {
                  background: 'rgba(30, 41, 59, 0.5)',
                  border: `1px solid ${member.color}30`,
                  borderRadius: '0.75rem',
                  overflow: 'hidden'
                }
              },
                // Member Header
                React.createElement('div', {
                  style: {
                    padding: '1.25rem',
                    background: `${member.color}15`,
                    borderBottom: `1px solid ${member.color}30`
                  }
                },
                  React.createElement('div', {
                    style: { display: 'flex', alignItems: 'center', gap: '0.75rem', marginBottom: '0.5rem' }
                  },
                    React.createElement('div', {
                      style: {
                        fontSize: '2rem',
                        width: '48px',
                        height: '48px',
                        display: 'flex',
                        alignItems: 'center',
                        justifyContent: 'center',
                        background: `${member.color}20`,
                        borderRadius: '50%',
                        border: `2px solid ${member.color}`
                      }
                    }, member.avatar),
                    React.createElement('div', null,
                      React.createElement('div', {
                        style: { fontSize: '1.125rem', fontWeight: '600', color: member.color }
                      }, member.name),
                      React.createElement('div', {
                        style: { fontSize: '0.75rem', color: 'rgb(148, 163, 184)' }
                      }, member.role)
                    )
                  ),
                  React.createElement('div', {
                    style: {
                      display: 'flex',
                      gap: '1rem',
                      fontSize: '0.875rem'
                    }
                  },
                    React.createElement('div', null,
                      React.createElement('span', {
                        style: { color: 'rgb(148, 163, 184)' }
                      }, 'Tasks: '),
                      React.createElement('span', {
                        style: { fontWeight: '600', color: member.color }
                      }, memberTasks.length)
                    ),
                    overdueCount > 0 && React.createElement('div', null,
                      React.createElement('span', {
                        style: { color: 'rgb(239, 68, 68)', fontWeight: '600' }
                      }, `${overdueCount} overdue`)
                    ),
                    urgentCount > 0 && React.createElement('div', null,
                      React.createElement('span', {
                        style: { color: 'rgb(251, 146, 60)', fontWeight: '600' }
                      }, `${urgentCount} urgent`)
                    )
                  )
                ),

                // Task List
                React.createElement('div', {
                  style: { padding: '1rem', maxHeight: '400px', overflowY: 'auto' }
                },
                  memberTasks.length === 0 ? 
                    React.createElement('div', {
                      style: {
                        padding: '2rem',
                        textAlign: 'center',
                        color: 'rgb(148, 163, 184)',
                        fontSize: '0.875rem'
                      }
                    }, 'No tasks assigned') :
                    memberTasks.map(task => 
                      React.createElement('div', {
                        key: `${task.utility.id}-${task.id}`,
                        style: {
                          padding: '0.75rem',
                          background: 'rgba(15, 23, 42, 0.5)',
                          border: task.status === 'overdue' ? '1px solid rgba(239, 68, 68, 0.3)' : '1px solid rgba(148, 163, 184, 0.1)',
                          borderRadius: '0.5rem',
                          marginBottom: '0.75rem',
                          cursor: 'pointer'
                        },
                        onClick: () => setSelectedUtility(task.utility)
                      },
                        React.createElement('div', {
                          style: {
                            fontSize: '0.625rem',
                            color: 'rgb(148, 163, 184)',
                            marginBottom: '0.25rem',
                            textTransform: 'uppercase',
                            letterSpacing: '0.05em'
                          }
                        }, task.utility.name),
                        React.createElement('div', {
                          style: {
                            fontWeight: '600',
                            marginBottom: '0.5rem',
                            fontSize: '0.875rem',
                            color: task.status === 'overdue' ? 'rgb(239, 68, 68)' : 'rgb(248, 250, 252)'
                          }
                        }, task.name),
                        React.createElement('div', {
                          style: {
                            display: 'flex',
                            justifyContent: 'space-between',
                            alignItems: 'center'
                          }
                        },
                          React.createElement('div', {
                            style: {
                              display: 'inline-block',
                              padding: '0.25rem 0.5rem',
                              background: `${getCategoryColor(task.category)}15`,
                              color: getCategoryColor(task.category),
                              borderRadius: '0.25rem',
                              fontSize: '0.625rem',
                              fontWeight: '700',
                              textTransform: 'uppercase'
                            }
                          }, task.category.replace('-', ' ')),
                          React.createElement('div', {
                            style: {
                              fontSize: '0.75rem',
                              fontWeight: '600',
                              color: task.daysUntilDue < 0 ? 'rgb(239, 68, 68)' : 
                                     task.daysUntilDue < 3 ? 'rgb(251, 146, 60)' : 'rgb(203, 213, 225)'
                            }
                          }, task.daysUntilDue < 0 ? `${Math.abs(task.daysUntilDue)}d overdue` : `Due in ${task.daysUntilDue}d`)
                        )
                      )
                    )
                )
              );
            })
          )
        ),

        // Utility Detail Modal
        selectedUtility && React.createElement('div', {
          style: {
            position: 'fixed',
            top: 0,
            left: 0,
            right: 0,
            bottom: 0,
            background: 'rgba(0, 0, 0, 0.8)',
            display: 'flex',
            alignItems: 'center',
            justifyContent: 'center',
            zIndex: 100,
            padding: '2rem'
          },
          onClick: () => setSelectedUtility(null)
        },
          React.createElement('div', {
            onClick: (e) => e.stopPropagation(),
            style: {
              background: 'rgb(30, 41, 59)',
              borderRadius: '1rem',
              maxWidth: '1200px',
              width: '100%',
              maxHeight: '90vh',
              overflow: 'auto',
              border: '1px solid rgba(148, 163, 184, 0.2)'
            }
          },
            // Modal Header
            React.createElement('div', {
              style: {
                padding: '2rem',
                borderBottom: '1px solid rgba(148, 163, 184, 0.1)',
                position: 'sticky',
                top: 0,
                background: 'rgb(30, 41, 59)',
                zIndex: 10
              }
            },
              React.createElement('div', { style: { display: 'flex', justifyContent: 'space-between', alignItems: 'start' } },
                React.createElement('div', null,
                  React.createElement('h2', { style: { margin: 0, fontSize: '1.5rem', fontWeight: '700' } }, selectedUtility.name),
                  React.createElement('p', { style: { margin: '0.5rem 0 0 0', fontSize: '0.875rem', color: 'rgb(148, 163, 184)' } },
                    `${selectedUtility.city} â€¢ ${selectedUtility.customerCount.toLocaleString()} customers`
                  )
                ),
                React.createElement('button', {
                  onClick: () => setSelectedUtility(null),
                  style: {
                    background: 'transparent',
                    border: 'none',
                    color: 'rgb(148, 163, 184)',
                    fontSize: '1.5rem',
                    cursor: 'pointer',
                    padding: '0.5rem'
                  }
                }, 'Ã—')
              ),
              React.createElement('div', { style: { display: 'flex', gap: '1rem', marginTop: '1.5rem' } },
                React.createElement('div', {
                  style: {
                    padding: '0.75rem 1rem',
                    background: `${getStatusColor(selectedUtility.healthStatus)}15`,
                    border: `1px solid ${getStatusColor(selectedUtility.healthStatus)}`,
                    borderRadius: '0.5rem'
                  }
                },
                  React.createElement('div', {
                    style: {
                      fontSize: '0.75rem',
                      color: 'rgb(148, 163, 184)',
                      marginBottom: '0.25rem',
                      textTransform: 'uppercase',
                      letterSpacing: '0.05em'
                    }
                  }, 'Health Status'),
                  React.createElement('div', {
                    style: {
                      fontSize: '1rem',
                      fontWeight: '700',
                      color: getStatusColor(selectedUtility.healthStatus),
                      textTransform: 'capitalize'
                    }
                  }, selectedUtility.healthStatus)
                ),
                React.createElement('div', {
                  style: {
                    padding: '0.75rem 1rem',
                    background: 'rgba(59, 130, 246, 0.1)',
                    border: '1px solid rgba(59, 130, 246, 0.3)',
                    borderRadius: '0.5rem'
                  }
                },
                  React.createElement('div', {
                    style: {
                      fontSize: '0.75rem',
                      color: 'rgb(148, 163, 184)',
                      marginBottom: '0.25rem',
                      textTransform: 'uppercase',
                      letterSpacing: '0.05em'
                    }
                  }, 'Risk Score'),
                  React.createElement('div', {
                    style: { fontSize: '1rem', fontWeight: '700', color: 'rgb(147, 197, 253)' }
                  }, selectedUtility.riskScore)
                )
              )
            ),

            // Modal Body with Tasks
            React.createElement('div', { style: { padding: '2rem', display: 'grid', gridTemplateColumns: '2fr 1fr', gap: '2rem' } },
              // Tasks Section
              React.createElement('div', null,
                React.createElement('h3', { style: { margin: '0 0 1rem 0', fontSize: '1.125rem', fontWeight: '600' } }, 'Outstanding Tasks'),
                ['blocker', 'disbursement-dependent', 'compliance', 'operational'].map(category => {
                  const categoryTasks = selectedUtility.tasks.filter(t => t.category === category);
                  if (categoryTasks.length === 0) return null;

                  return React.createElement('div', { key: category, style: { marginBottom: '1.5rem' } },
                    React.createElement('div', {
                      style: {
                        display: 'inline-block',
                        padding: '0.25rem 0.75rem',
                        background: `${getCategoryColor(category)}20`,
                        color: getCategoryColor(category),
                        borderRadius: '0.25rem',
                        fontSize: '0.75rem',
                        fontWeight: '700',
                        textTransform: 'uppercase',
                        letterSpacing: '0.05em',
                        marginBottom: '0.75rem'
                      }
                    }, `${category} (${categoryTasks.length})`),
                    categoryTasks.map(task =>
                      React.createElement('div', {
                        key: task.id,
                        style: {
                          padding: '1rem',
                          background: 'rgba(15, 23, 42, 0.5)',
                          border: task.status === 'overdue' ? '1px solid rgba(239, 68, 68, 0.3)' : '1px solid rgba(148, 163, 184, 0.1)',
                          borderRadius: '0.5rem',
                          marginBottom: '0.75rem'
                        }
                      },
                        React.createElement('div', {
                          style: {
                            fontWeight: '600',
                            marginBottom: '0.5rem',
                            color: task.status === 'overdue' ? 'rgb(239, 68, 68)' : 'rgb(248, 250, 252)'
                          }
                        }, task.name),
                        React.createElement('div', {
                          style: { fontSize: '0.75rem', color: 'rgb(148, 163, 184)', marginBottom: '0.75rem' }
                        }, `Assigned ${task.daysSinceAssigned} days ago â€¢ Last contact ${task.lastContactDays} days ago`),
                        React.createElement('div', {
                          style: {
                            display: 'flex',
                            gap: '0.75rem',
                            paddingTop: '0.75rem',
                            borderTop: '1px solid rgba(148, 163, 184, 0.1)',
                            alignItems: 'center'
                          }
                        },
                          React.createElement('div', { style: { flex: 1 } },
                            React.createElement('div', {
                              style: { fontSize: '0.75rem', color: 'rgb(148, 163, 184)', marginBottom: '0.25rem' }
                            }, 'Assigned to'),
                            React.createElement('div', {
                              style: { fontSize: '0.875rem', color: 'rgb(203, 213, 225)' }
                            }, task.assignedTo.name),
                            React.createElement('div', {
                              style: { fontSize: '0.75rem', color: 'rgb(148, 163, 184)' }
                            }, task.assignedTo.role)
                          ),
                          React.createElement('div', {
                            style: {
                              padding: '0.5rem 0.75rem',
                              background: task.daysUntilDue < 0 ? 'rgba(239, 68, 68, 0.2)' : 'rgba(148, 163, 184, 0.2)',
                              color: task.daysUntilDue < 0 ? 'rgb(239, 68, 68)' : 'rgb(203, 213, 225)',
                              borderRadius: '0.25rem',
                              fontSize: '0.75rem',
                              fontWeight: '700',
                              whiteSpace: 'nowrap'
                            }
                          }, task.daysUntilDue < 0 ? `${Math.abs(task.daysUntilDue)}d overdue` : `Due in ${task.daysUntilDue}d`),
                          React.createElement('button', {
                            onClick: () => setEmailDraft(generateEmailDraft(selectedUtility, task)),
                            style: {
                              padding: '0.5rem 1rem',
                              background: 'rgba(59, 130, 246, 0.2)',
                              border: '1px solid rgb(59, 130, 246)',
                              borderRadius: '0.375rem',
                              color: 'rgb(147, 197, 253)',
                              cursor: 'pointer',
                              fontSize: '0.875rem',
                              fontWeight: '500',
                              display: 'flex',
                              alignItems: 'center',
                              gap: '0.5rem'
                            }
                          },
                            React.createElement(Send, { size: 14 }),
                            'Send Reminder'
                          )
                        )
                      )
                    )
                  );
                })
              ),

              // Contacts Section
              React.createElement('div', null,
                React.createElement('h3', { style: { margin: '0 0 1rem 0', fontSize: '1.125rem', fontWeight: '600' } }, 'Contacts'),
                selectedUtility.contacts.map(contact =>
                  React.createElement('div', {
                    key: contact.id,
                    style: {
                      padding: '1rem',
                      background: 'rgba(15, 23, 42, 0.5)',
                      border: '1px solid rgba(148, 163, 184, 0.1)',
                      borderRadius: '0.5rem',
                      marginBottom: '0.75rem'
                    }
                  },
                    React.createElement('div', { style: { fontWeight: '600', marginBottom: '0.25rem' } }, contact.name),
                    React.createElement('div', { style: { fontSize: '0.75rem', color: 'rgb(148, 163, 184)', marginBottom: '0.75rem' } }, contact.role),
                    React.createElement('div', {
                      style: {
                        display: 'flex',
                        alignItems: 'center',
                        gap: '0.5rem',
                        fontSize: '0.875rem',
                        color: 'rgb(203, 213, 225)',
                        marginBottom: '0.5rem'
                      }
                    },
                      React.createElement(Mail, { size: 14, style: { color: 'rgb(148, 163, 184)' } }),
                      contact.email
                    ),
                    React.createElement('div', {
                      style: {
                        display: 'flex',
                        alignItems: 'center',
                        gap: '0.5rem',
                        fontSize: '0.875rem',
                        color: 'rgb(203, 213, 225)',
                        marginBottom: '0.75rem'
                      }
                    },
                      React.createElement(Phone, { size: 14, style: { color: 'rgb(148, 163, 184)' } }),
                      contact.phone
                    ),
                    React.createElement('div', {
                      style: {
                        paddingTop: '0.75rem',
                        borderTop: '1px solid rgba(148, 163, 184, 0.1)',
                        fontSize: '0.75rem',
                        color: 'rgb(148, 163, 184)'
                      }
                    }, `Avg response: ${contact.responseTime} days`)
                  )
                )
              )
            )
          )
        ),

        // Email Draft Modal
        emailDraft && React.createElement('div', {
          style: {
            position: 'fixed',
            top: 0,
            left: 0,
            right: 0,
            bottom: 0,
            background: 'rgba(0, 0, 0, 0.8)',
            display: 'flex',
            alignItems: 'center',
            justifyContent: 'center',
            zIndex: 200,
            padding: '2rem'
          },
          onClick: () => setEmailDraft(null)
        },
          React.createElement('div', {
            onClick: (e) => e.stopPropagation(),
            style: {
              background: 'rgb(30, 41, 59)',
              borderRadius: '1rem',
              maxWidth: '800px',
              width: '100%',
              maxHeight: '90vh',
              overflow: 'auto',
              border: '1px solid rgba(148, 163, 184, 0.2)'
            }
          },
            React.createElement('div', {
              style: {
                padding: '2rem',
                borderBottom: '1px solid rgba(148, 163, 184, 0.1)'
              }
            },
              React.createElement('div', { style: { display: 'flex', justifyContent: 'space-between', alignItems: 'start' } },
                React.createElement('div', null,
                  React.createElement('h2', { 
                    style: { margin: 0, fontSize: '1.5rem', fontWeight: '700', display: 'flex', alignItems: 'center', gap: '0.75rem' } 
                  },
                    React.createElement(Mail, { size: 24, style: { color: 'rgb(59, 130, 246)' } }),
                    'Email Draft Preview'
                  ),
                  React.createElement('p', { style: { margin: '0.5rem 0 0 0', fontSize: '0.875rem', color: 'rgb(148, 163, 184)' } },
                    'Review before sending â€¢ This is a preview only'
                  )
                ),
                React.createElement('button', {
                  onClick: () => setEmailDraft(null),
                  style: {
                    background: 'transparent',
                    border: 'none',
                    color: 'rgb(148, 163, 184)',
                    fontSize: '1.5rem',
                    cursor: 'pointer',
                    padding: '0.5rem'
                  }
                }, 'Ã—')
              )
            ),
            React.createElement('div', { style: { padding: '2rem' } },
              React.createElement('div', {
                style: {
                  background: 'rgba(15, 23, 42, 0.5)',
                  border: '1px solid rgba(148, 163, 184, 0.1)',
                  borderRadius: '0.5rem',
                  padding: '1.5rem',
                  marginBottom: '1.5rem'
                }
              },
                React.createElement('div', { style: { marginBottom: '1rem' } },
                  React.createElement('div', { style: { fontSize: '0.75rem', color: 'rgb(148, 163, 184)', marginBottom: '0.25rem' } }, 'To:'),
                  React.createElement('div', { style: { fontSize: '1rem', color: 'rgb(248, 250, 252)' } }, emailDraft.to),
                  React.createElement('div', { style: { fontSize: '0.875rem', color: 'rgb(148, 163, 184)' } }, 
                    `${emailDraft.contact.name} - ${emailDraft.contact.role}`
                  )
                ),
                React.createElement('div', { style: { marginBottom: '1rem' } },
                  React.createElement('div', { style: { fontSize: '0.75rem', color: 'rgb(148, 163, 184)', marginBottom: '0.25rem' } }, 'Subject:'),
                  React.createElement('div', { style: { fontSize: '1rem', color: 'rgb(248, 250, 252)', fontWeight: '600' } }, emailDraft.subject)
                )
              ),
              React.createElement('div', {
                style: {
                  background: 'rgba(15, 23, 42, 0.5)',
                  border: '1px solid rgba(148, 163, 184, 0.1)',
                  borderRadius: '0.5rem',
                  padding: '1.5rem',
                  marginBottom: '1.5rem'
                }
              },
                React.createElement('div', {
                  style: {
                    fontSize: '0.9375rem',
                    lineHeight: '1.6',
                    color: 'rgb(203, 213, 225)',
                    whiteSpace: 'pre-wrap',
                    fontFamily: 'Georgia, serif'
                  }
                }, emailDraft.body)
              ),
              React.createElement('div', { style: { display: 'flex', gap: '1rem', justifyContent: 'flex-end' } },
                React.createElement('button', {
                  onClick: () => setEmailDraft(null),
                  style: {
                    padding: '0.75rem 1.5rem',
                    background: 'transparent',
                    border: '1px solid rgba(148, 163, 184, 0.2)',
                    borderRadius: '0.5rem',
                    color: 'rgb(203, 213, 225)',
                    cursor: 'pointer',
                    fontSize: '0.875rem',
                    fontWeight: '500'
                  }
                }, 'Close'),
                React.createElement('button', {
                  onClick: () => {
                    navigator.clipboard.writeText(`To: ${emailDraft.to}\nSubject: ${emailDraft.subject}\n\n${emailDraft.body}`);
                    alert('Email draft copied to clipboard!');
                  },
                  style: {
                    padding: '0.75rem 1.5rem',
                    background: 'rgba(59, 130, 246, 0.2)',
                    border: '1px solid rgb(59, 130, 246)',
                    borderRadius: '0.5rem',
                    color: 'rgb(147, 197, 253)',
                    cursor: 'pointer',
                    fontSize: '0.875rem',
                    fontWeight: '500'
                  }
                }, 'Copy to Clipboard')
              )
            )
          )
        )
      );
    };

    const ActionStatCard = ({ label, value, color, icon, onClick, description }) => 
      React.createElement('div', {
        onClick: onClick,
        style: {
          padding: '1.5rem',
          background: 'rgba(30, 41, 59, 0.5)',
          border: '1px solid rgba(148, 163, 184, 0.1)',
          borderRadius: '0.75rem',
          position: 'relative',
          overflow: 'hidden',
          cursor: 'pointer',
          transition: 'all 0.2s'
        },
        onMouseEnter: (e) => {
          e.currentTarget.style.background = 'rgba(30, 41, 59, 0.8)';
          e.currentTarget.style.border = `1px solid ${color}40`;
          e.currentTarget.style.transform = 'translateY(-2px)';
          e.currentTarget.style.boxShadow = `0 4px 12px ${color}20`;
        },
        onMouseLeave: (e) => {
          e.currentTarget.style.background = 'rgba(30, 41, 59, 0.5)';
          e.currentTarget.style.border = '1px solid rgba(148, 163, 184, 0.1)';
          e.currentTarget.style.transform = 'translateY(0)';
          e.currentTarget.style.boxShadow = 'none';
        }
      },
        React.createElement('div', {
          style: {
            position: 'absolute',
            top: '1rem',
            right: '1rem',
            fontSize: '2rem',
            opacity: 0.3
          }
        }, icon),
        React.createElement('div', {
          style: {
            fontSize: '2.5rem',
            fontWeight: '700',
            color,
            marginBottom: '0.5rem'
          }
        }, value),
        React.createElement('div', {
          style: {
            fontSize: '0.875rem',
            color: 'rgb(203, 213, 225)',
            fontWeight: '600',
            marginBottom: '0.25rem'
          }
        }, label),
        React.createElement('div', {
          style: {
            fontSize: '0.75rem',
            color: 'rgb(148, 163, 184)',
            fontStyle: 'italic'
          }
        }, description),
        React.createElement('div', {
          style: {
            marginTop: '0.75rem',
            fontSize: '0.75rem',
            color,
            fontWeight: '500',
            display: 'flex',
            alignItems: 'center',
            gap: '0.25rem'
          }
        }, 
          'Click to view â†’'
        )
      );

    // Render the app
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(React.createElement(UtilityDashboard));
  </script>
</body>
</html>
